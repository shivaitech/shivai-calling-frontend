var ks=Object.defineProperty;var Ns=(t,a,l)=>a in t?ks(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;var me=(t,a,l)=>Ns(t,typeof a!="symbol"?a+"":a,l);import{r as g,j as e,R as yt,k as It,l as Cs,u as Ss,f as Ts,i as Es,e as Ls}from"./index-CPbfZ6nP.js";import{G as R}from"./GlassCard-R5rGIODE.js";import{C as Ps}from"./chevron-down-t4jhLEJZ.js";import{S as rt}from"./search-DaenUIK4.js";import{C as As}from"./check-CUWx_J4I.js";import{R as kt,S as $t,a as Ds}from"./shield-Cunr0WaI.js";import{c as je}from"./createLucideIcon-BrIoDXBn.js";import{C as Ue}from"./copy-CDGfrhmV.js";import{X as nt}from"./x-B42cDF9g.js";import{M as le}from"./message-square-DxQ89te2.js";import{M as Ms,F as Nt}from"./map-pin-BQbs4H5K.js";import{C as Rs,P as Re}from"./pause-BCVFalff.js";import{C as be}from"./clock-SzouNKJW.js";import{L as Is,M as $s}from"./mic-Cb6HTBej.js";import{F as Ct}from"./file-text-4LgTIjM-.js";import{U as Fe}from"./users-Cmk_mWOz.js";import{i as _s}from"./utils-Y-nI2RCH.js";import{P as Bs}from"./plus-CeI27pgF.js";import{B as Ce}from"./bot-CyrlkLe7.js";import{E as St}from"./eye-DnL6Pe6y.js";import{S as Ie}from"./square-pen-CWqJAf2B.js";import{Z as Tt}from"./zap-BvbmNsg4.js";import{P as st}from"./play-B-y-PlWt.js";import{T as Os}from"./trash-2-C-vXqg3i.js";import{A as Et}from"./arrow-left-DaT0M88Y.js";import{G as Lt}from"./globe-DwhrdbJN.js";import{C as Pt}from"./check-circle-BUZFnlaV.js";import{S as $e}from"./settings-DWT2NZ9X.js";import{L as _e}from"./lightbulb-CQO2d27Q.js";import{D as At}from"./download-DsCTfMxS.js";import{B as Dt}from"./bar-chart-3-BA_wS-LS.js";import{P as at}from"./phone-BkvE7xTs.js";import{I as Us}from"./info-CN8NWJF3.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=je("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=je("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=je("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=je("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=je("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=je("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),pe=({options:t,value:a,onChange:l,placeholder:r="Select option...",className:s="",groupBy:o=!1})=>{const[i,c]=g.useState(!1),[m,u]=g.useState(""),d=g.useRef(null),[w,f]=g.useState("bottom"),[k,A]=g.useState({}),D=t.filter(N=>N.label.toLowerCase().includes(m.toLowerCase())||N.value.toLowerCase().includes(m.toLowerCase())),y=o?D.reduce((N,$)=>{const b=$.group||"All";return N[b]||(N[b]=[]),N[b].push($),N},{}):{"":D},h=t.find(N=>N.value===a),T=g.useCallback(()=>{if(d.current){const N=d.current.getBoundingClientRect(),$=window.innerHeight-N.bottom,b=300,se=$<b&&N.top>b?"top":"bottom";f(se)}},[]);g.useEffect(()=>{if(i){T();const N=()=>T(),$=()=>T();return window.addEventListener("scroll",N,!0),window.addEventListener("resize",$),()=>{window.removeEventListener("scroll",N,!0),window.removeEventListener("resize",$)}}},[i,T]),g.useEffect(()=>{const N=$=>{d.current&&!d.current.contains($.target)&&(c(!1),u(""))};if(i)return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[i]);const H=N=>{l(N),c(!1),u("")},K=()=>{c(!i)};return e.jsxs("div",{ref:d,className:`relative ${s}`,children:[e.jsxs("button",{onClick:K,className:"w-full flex items-center justify-between px-4 py-3 bg-white/50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500/20 text-slate-800 dark:text-white",children:[e.jsx("span",{className:h?"":"text-slate-500 dark:text-slate-400",children:(h==null?void 0:h.label)||r}),e.jsx(Ps,{className:`w-4 h-4 text-slate-400 transition-transform flex-shrink-0 ml-2 ${i?"rotate-180":""}`})]}),i&&e.jsxs("div",{className:"absolute top-14 w-full bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-xl max-h-80 overflow-y-auto z-[99999] no-scrollbar",style:k,children:[e.jsx("div",{className:"p-3 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:m,onChange:N=>u(N.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 text-slate-800 dark:text-white"})]})}),e.jsxs("div",{className:"max-h-64 overflow-y-auto",children:[Object.entries(y).map(([N,$])=>e.jsxs("div",{children:[o&&N&&e.jsx("div",{className:"px-4 py-2 text-xs font-medium text-slate-600 dark:text-slate-400 bg-slate-50 dark:bg-slate-700/50 sticky top-0",children:N}),$.map(b=>e.jsxs("button",{onClick:()=>H(b.value),className:`w-full text-left px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors flex items-center justify-between text-sm ${a===b.value?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300":"text-slate-700 dark:text-slate-300"}`,children:[e.jsx("span",{children:b.label}),a===b.value&&e.jsx(As,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})]},b.value))]},N)),D.length===0&&e.jsxs("div",{className:"p-6 text-center text-slate-500 dark:text-slate-400",children:['No options found matching "',m,'"']})]})]})]})},Gs=({content:t,children:a,position:l="top",className:r=""})=>{const[s,o]=g.useState(!1),i={top:"bottom-full left-1/2 transform -translate-x-1/2 mb-2",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-2",left:"right-full top-1/2 transform -translate-y-1/2 mr-2",right:"left-full top-1/2 transform -translate-y-1/2 ml-2"},c={top:"top-full left-1/2 transform -translate-x-1/2 border-l-transparent border-r-transparent border-b-transparent border-t-slate-800 dark:border-t-slate-200",bottom:"bottom-full left-1/2 transform -translate-x-1/2 border-l-transparent border-r-transparent border-t-transparent border-b-slate-800 dark:border-b-slate-200",left:"left-full top-1/2 transform -translate-y-1/2 border-t-transparent border-b-transparent border-r-transparent border-l-slate-800 dark:border-l-slate-200",right:"right-full top-1/2 transform -translate-y-1/2 border-t-transparent border-b-transparent border-l-transparent border-r-slate-800 dark:border-r-slate-200"};return e.jsxs("div",{className:`relative inline-block ${r}`,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[a,s&&e.jsx("div",{className:`absolute z-[999999] ${i[l]} pointer-events-none`,children:e.jsxs("div",{className:"bg-slate-800 dark:bg-slate-200 text-white dark:text-slate-800 text-sm px-4 py-3 rounded-lg shadow-2xl max-w-sm whitespace-normal leading-relaxed border border-slate-700 dark:border-slate-300",children:[t,e.jsx("div",{className:`absolute w-0 h-0 border-[6px] ${c[l]}`})]})})]})},Qs=({agentId:t,agentName:a,isPublished:l=!1})=>{const[r,s]=g.useState("configure"),[o,i]=g.useState("mobile"),[c,m]=g.useState(!1),[u,d]=g.useState(!1),[w,f]=g.useState(null),[k,A]=g.useState(!1),[D,y]=g.useState(""),[h,T]=g.useState(0),H=g.useRef(null),K=g.useRef(null),N=[{id:"original",name:"Original Default",primaryColor:"#4b5563",secondaryColor:"#6b7280",accentColor:"#374151",gradient:"linear-gradient(135deg, #4b5563 0%, #6b7280 30%, #374151 70%, #1f2937 100%)"},{id:"default",name:"ShivAI Blue",primaryColor:"#3b82f6",secondaryColor:"#1e40af",accentColor:"#2563eb",gradient:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"},{id:"ocean",name:"Ocean Breeze",primaryColor:"#0ea5e9",secondaryColor:"#0284c7",accentColor:"#0369a1",gradient:"linear-gradient(135deg, #0ea5e9 0%, #0369a1 100%)"},{id:"sunset",name:"Sunset Glow",primaryColor:"#f97316",secondaryColor:"#ea580c",accentColor:"#dc2626",gradient:"linear-gradient(135deg, #f97316 0%, #dc2626 100%)"},{id:"forest",name:"Forest Green",primaryColor:"#22c55e",secondaryColor:"#16a34a",accentColor:"#15803d",gradient:"linear-gradient(135deg, #22c55e 0%, #15803d 100%)"},{id:"purple",name:"Purple Dream",primaryColor:"#a855f7",secondaryColor:"#9333ea",accentColor:"#7c3aed",gradient:"linear-gradient(135deg, #a855f7 0%, #7c3aed 100%)"},{id:"teal",name:"Teal Wave",primaryColor:"#14b8a6",secondaryColor:"#0d9488",accentColor:"#0f766e",gradient:"linear-gradient(135deg, #14b8a6 0%, #0f766e 100%)"},{id:"rose",name:"Rose Garden",primaryColor:"#f43f5e",secondaryColor:"#e11d48",accentColor:"#be123c",gradient:"linear-gradient(135deg, #f43f5e 0%, #be123c 100%)"},{id:"gradient1",name:"Cosmic Fusion",primaryColor:"#6366f1",secondaryColor:"#8b5cf6",accentColor:"#a855f7",gradient:"linear-gradient(135deg, #6366f1 0%, #a855f7 100%)"},{id:"gradient2",name:"Warm Citrus",primaryColor:"#fbbf24",secondaryColor:"#f59e0b",accentColor:"#d97706",gradient:"linear-gradient(135deg, #fbbf24 0%, #d97706 100%)"},{id:"gradient3",name:"Cool Mint",primaryColor:"#34d399",secondaryColor:"#10b981",accentColor:"#059669",gradient:"linear-gradient(135deg, #34d399 0%, #059669 100%)"}],$=j=>{const C={...b,theme:{...b.theme,primaryColor:j.primaryColor,secondaryColor:j.secondaryColor,accentColor:j.accentColor}};se(C),A(!0);const M=new CustomEvent("widgetConfigUpdated",{detail:{agentId:t,config:C}});window.dispatchEvent(M),setTimeout(()=>{T(Q=>Q+1)},50)};g.useEffect(()=>{!l&&(r==="install"||r==="advanced")&&s("preview")},[l,r]);const[b,se]=g.useState({theme:{primaryColor:"#4b5563",secondaryColor:"#6b7280",accentColor:"#374151",borderRadius:"16px",buttonStyle:"floating",widgetStyle:"modern"},ui:{position:"bottom-right",buttonSize:"medium",chatHeight:"320px",chatWidth:"380px",autoOpen:!1,minimizeButton:!0,draggable:!0},content:{welcomeMessage:`Hi! I'm ${a}. How can I help you today?`,companyName:a,companyDescription:"AI-Powered Support - We offer 24/7 voice support to handle your business calls effieciently and professionally.",companyLogo:"",placeholderText:"Type your message...",offlineMessage:"We're currently offline. Please leave a message."},features:{voiceEnabled:!0,soundEffects:!0,showBranding:!0,messageHistory:!0,typingIndicator:!0,fileUpload:!1},customCSS:""});g.useEffect(()=>((async()=>{d(!0);try{const C=await fetch(`/api/agents/${t}/widget-config`);if(C.ok){const M=await C.json();se(M),f(new Date(M.updatedAt||Date.now())),console.log("âœ… Widget configuration loaded")}}catch(C){console.error("Failed to load widget configuration:",C)}finally{d(!1)}})(),()=>{K.current&&clearTimeout(K.current)}),[t]);const We=j=>{var M;const C=(M=j.target.files)==null?void 0:M[0];if(C){const Q=new FileReader;Q.onloadend=()=>{const ae=Q.result;y(ae),he("content","companyLogo",ae)},Q.readAsDataURL(C)}},Te=async()=>{m(!0);try{const j=await fetch(`/api/agents/${t}/widget-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:t,config:b,timestamp:new Date().toISOString()})});if(!j.ok)throw new Error(`HTTP error! status: ${j.status}`);await j.json(),f(new Date),A(!1),await Ge(),T(Q=>Q+1);const C=new CustomEvent("widgetConfigUpdated",{detail:{agentId:t,config:b}});window.dispatchEvent(C),console.log("âœ… Widget configuration saved successfully");const M=document.createElement("div");M.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 transition-all",M.textContent="Widget configuration saved!",document.body.appendChild(M),setTimeout(()=>{M.remove()},3e3)}catch(j){console.error("Failed to save widget configuration:",j),alert("Failed to save widget configuration. Please try again.")}finally{m(!1)}},Ge=async()=>{try{const j=await Ee();if(!(await fetch("/api/widget/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentId:t,widgetCode:j,config:b})})).ok)throw new Error("Failed to update widget.js");console.log("âœ… Widget.js updated successfully")}catch(j){console.error("Failed to update widget.js:",j)}},Ee=async()=>{let C=await(await fetch("/widget.js")).text();return C=C.replace(/background: linear-gradient\(135deg, #4b5563 0%, #6b7280 30%, #374151 70%, #1f2937 100%\)/g,`background: linear-gradient(135deg, ${b.theme.primaryColor} 0%, ${b.theme.accentColor} 100%)`),C=C.replace(/bottom: 20px;\s*right: 20px;/g,`${b.ui.position.includes("bottom")?"bottom":"top"}: 20px; ${b.ui.position.includes("right")?"right":"left"}: 20px;`),C=C.replace(/"ShivAI Employee"/g,`"${b.content.companyName}"`),C=C.replace(/"AI-Powered Support"/g,`"${b.content.companyDescription}"`),b.customCSS&&(C=C.replace("// Custom styles will be inserted here",b.customCSS)),C},he=(j,C,M)=>{const Q={...b,[j]:{...b[j],[C]:M}};se(Q),A(!0);const ae=new CustomEvent("widgetConfigUpdated",{detail:{agentId:t,config:Q}});window.dispatchEvent(ae),K.current&&clearTimeout(K.current),K.current=window.setTimeout(()=>{T(it=>it+1)},500)};return e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-6",children:[u&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Loading widget configuration..."})]}),!u&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-slate-800 dark:text-white mb-4 flex items-center gap-3",children:["Widget Customization",k&&e.jsx("span",{className:"text-xs bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400 px-2 py-1 rounded-full",children:"Unsaved changes"}),w&&e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Last saved: ",w.toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex gap-2 mb-6 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>s("configure"),className:`px-4 py-2 text-sm font-medium transition-colors ${r==="configure"?"text-blue-600 dark:text-blue-400 border-b-2 border-blue-600 dark:border-blue-400":"text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200"}`,children:"Configure"}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("button",{onClick:()=>T(j=>j+1),disabled:r!=="preview",className:"p-2 text-slate-600 hover:text-slate-800 dark:text-slate-400 dark:hover:text-slate-200 disabled:opacity-50 transition-colors",title:"Refresh Preview",children:e.jsx(kt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:Te,disabled:c||!k,className:"common-button-bg text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx($t,{className:"w-4 h-4"}),"Save Changes"]})})]})]}),r==="configure"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Company Branding"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 dark:text-slate-400 mb-2",children:"Company Logo"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-20 h-20 common-bg-icons rounded-lg flex items-center justify-center overflow-hidden flex-shrink-0",children:D||b.content.companyLogo?e.jsx("img",{src:D||b.content.companyLogo,alt:"Company Logo",className:"w-full h-full object-contain"}):e.jsx("div",{className:"text-slate-400 text-center text-xs p-2",children:"No logo"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",id:"logo-upload",accept:"image/*",onChange:We,className:"hidden"}),e.jsx("label",{htmlFor:"logo-upload",className:"inline-block common-button-bg text-white px-4 py-2 rounded-lg text-sm cursor-pointer hover:opacity-90 transition-opacity",children:"Upload Logo"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"Recommended: 200x200px, PNG or SVG, max 2MB"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 dark:text-slate-400 mb-2",children:"AI Employee Name *"}),e.jsx("input",{type:"text",value:b.content.companyName,onChange:j=>he("content","companyName",j.target.value),placeholder:"Enter your company name",className:"common-bg-icons w-full px-3 py-2 rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 dark:text-slate-400 mb-2",children:"AI Employee Description"}),e.jsx("textarea",{value:b.content.companyDescription,onChange:j=>he("content","companyDescription",j.target.value),placeholder:"AI-Powered Support - We offer 24/7 voice support to handle your business calls...",rows:3,className:"common-bg-icons w-full px-3 py-2 rounded-lg text-sm resize-none"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:"Theme & Colors"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-600 dark:text-slate-400 mb-3",children:"Choose a Gradient Theme"}),e.jsx("div",{className:"lg:hidden",children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:N.map(j=>{const C=b.theme.primaryColor===j.primaryColor&&b.theme.accentColor===j.accentColor;return e.jsxs("button",{onClick:()=>$(j),className:`relative group h-14 rounded-lg border-2 transition-all duration-200 ${C?"border-blue-500 ring-1 ring-blue-200 dark:ring-blue-800":"border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600"}`,style:{background:j.gradient},title:j.name,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent rounded-md"}),e.jsxs("div",{className:"relative h-full flex flex-col items-center justify-center text-white",children:[e.jsx("div",{className:"text-[9px] font-medium opacity-90 px-0.5 text-center leading-tight",children:j.name}),C&&e.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center border border-white",children:e.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})]},j.id)})})}),e.jsx("div",{className:"hidden lg:grid grid-cols-2 gap-3",children:N.map(j=>{const C=b.theme.primaryColor===j.primaryColor&&b.theme.accentColor===j.accentColor;return e.jsxs("button",{onClick:()=>$(j),className:`relative group h-16 rounded-lg border-2 transition-all duration-200 ${C?"border-blue-500 ring-2 ring-blue-200 dark:ring-blue-800":"border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600"}`,style:{background:j.gradient},title:j.name,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent rounded-md"}),e.jsxs("div",{className:"relative h-full flex flex-col items-center justify-center text-white",children:[e.jsx("div",{className:"text-xs font-medium mb-1 opacity-90",children:j.name}),C&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center border-2 border-white",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})]},j.id)})}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"Select a preset theme or customize individual colors below"})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300",children:"Live Preview"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>i("mobile"),className:`p-2 rounded-lg transition-colors ${o==="mobile"?"common-button-bg text-white":"common-bg-icons text-slate-600 dark:text-slate-400"}`,children:e.jsx(Ws,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>i("desktop"),className:`p-2 rounded-lg transition-colors ${o==="desktop"?"common-button-bg text-white":"common-bg-icons text-slate-600 dark:text-slate-400"}`,children:e.jsx(zs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(j=>j+1),className:"p-2 rounded-lg common-bg-icons text-slate-600 dark:text-slate-400 hover:opacity-90 transition-opacity",title:"Refresh Preview",children:e.jsx(kt,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:`relative bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-800 dark:to-slate-900 rounded-xl overflow-hidden ${o==="mobile"?"h-[600px]":"h-[500px]"}`,children:e.jsx("iframe",{ref:H,srcDoc:`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget Preview</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0e7ff 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .demo-content {
            text-align: center;
            max-width: 600px;
            width: 100%;
            padding: 2rem;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .company-header {
            margin-bottom: 2rem;
        }
        .company-logo {
            width: 80px;
            height: 80px;
            border-radius: 16px;
            margin: 0 auto 1rem;
            display: block;
            object-fit: cover;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .company-name {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }
        .company-description {
           y font-size: 1.1rem;
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 2rem;
        }
        .demo-text {
            color: #4b5563;
            font-size: 1rem;
            margin-bottom: 1rem;
        }
        .device-badge {
            display: inline-block;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        @media (max-width: 768px) {
            body { padding: 10px; }
            .demo-content { padding: 1.5rem; }
            .company-name { font-size: 1.5rem; }
            .company-description { font-size: 1rem; }
        }
    </style>
</head>
<body>
    <div class="">
      
        
      



<div class="demo-text">
  <strong> Test Your AI Employee Widget:</strong>
</div>
<div style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 1.5rem; margin: 1rem 0; text-align: left;">
  <div style="color: #374151; font-size: 0.9rem; line-height: 1.6;">
    <p style="margin: 0 0 1rem 0; font-weight: 600; color: #1f2937;">
      ðŸ“‹ How to test:
    </p>
    <ol style="margin: 0; padding-left: 1.5rem; color: #4b5563;">
      <li style="margin-bottom: 0.75rem;">
        <strong>Look for the call button</strong> - It should appear in the bottom-right corner
      </li>
      <li style="margin-bottom: 0.75rem;">
        <strong>Click to open</strong> - Test the interface and your custom branding
      </li>
      <li style="margin-bottom: 0.75rem;">
        <strong>Try voice features</strong> - Click the Start call button icon to test voice input of AI Employee
      </li>
      <li style="margin-bottom: 0;">
        <strong>Check response and Other Features</strong> - Send messages, view Transcripts, and see how the AI responds
      </li>
    </ol>
    <div style="margin-top: 1rem; padding: 0.75rem; background: #dbeafe; border-radius: 8px; border-left: 4px solid #3b82f6;">
      <p style="margin: 0; font-size: 0.85rem; color: #1e40af;">
        ðŸ’¡ <strong>Tip:</strong> Make changes in the customization panel and see them update in real-time!
      </p>
    </div>
  </div>
</div>
    </div>

    <!-- Pass configuration to widget -->
    <script>
        // Debug: Log agentId being passed to configure widget
        console.log("ðŸ” Setting configure widget agentId:", "${t}");
        
        window.ShivAI = window.ShivAI || {};
        window.ShivAI.config = {
            companyName: "${b.content.companyName}",
            companyDescription: "${b.content.companyDescription}",
            ${b.content.companyLogo?`companyLogo: "${b.content.companyLogo}",`:""}
        };
        
        // Also set SHIVAI_CONFIG for agent ID
        window.SHIVAI_CONFIG = {
            agentId: "${t}",
            theme: ${JSON.stringify(b.theme)},
            ui: ${JSON.stringify(b.ui)},
            content: ${JSON.stringify(b.content)},
            features: ${JSON.stringify(b.features)}
        };
        
        console.log("âœ… Configure widget SHIVAI_CONFIG set:", window.SHIVAI_CONFIG);
        
        // Refresh widget theme after config is set
        setTimeout(() => {
            if (window.ShivAIWidget && window.ShivAIWidget.refreshTheme) {
                window.ShivAIWidget.refreshTheme();
                console.log("ðŸŽ¨ Theme refreshed in configure view");
            }
        }, 100);
    <\/script>
    
    <!-- Load the actual widget.js -->
    <script src="/widget.js?agentId=${t}&companyName=${encodeURIComponent(b.content.companyName)}&companyDescription=${encodeURIComponent(b.content.companyDescription)}&agentName=${encodeURIComponent(b.content.companyName)}&v=${Date.now()}"><\/script>
</body>
</html>`,className:"w-full h-full border-0",title:"Widget Preview",sandbox:"allow-scripts allow-same-origin"},`${h}-${JSON.stringify(b.content)}`)})]})]})]})]})})},Js=({currentAgent:t})=>{const[a,l]=g.useState({theme:{primaryColor:"#4b5563",secondaryColor:"#6b7280",accentColor:"#374151",borderRadius:"16px",buttonStyle:"floating",widgetStyle:"modern"},ui:{position:"bottom-right",buttonSize:"medium",chatHeight:"320px",chatWidth:"380px",autoOpen:!1,minimizeButton:!0,draggable:!0},content:{welcomeMessage:`Hi! I'm ${t.name}. How can I help you today?`,companyName:t.name,companyDescription:"AI-Powered Support - We offer 24/7 voice support to handle your business calls efficiently and professionally.",companyLogo:"",placeholderText:"Type your message...",offlineMessage:"We're currently offline. Please leave a message."},features:{voiceEnabled:!0,soundEffects:!0,showBranding:!0,messageHistory:!0,typingIndicator:!0,fileUpload:!1},customCSS:""});g.useEffect(()=>{(async()=>{try{const m=await fetch(`/api/agents/${t.id}/widget-config`);if(m.ok){const u=await m.json();l(u)}}catch(m){console.error("Failed to load widget configuration:",m)}})();const c=m=>{m.detail.agentId===t.id&&l(m.detail.config)};return window.addEventListener("widgetConfigUpdated",c),()=>{window.removeEventListener("widgetConfigUpdated",c)}},[t.id]);const s=`<script src="${`https://callshivai.com/widget.js?${new URLSearchParams({agentId:t.id,agentName:t.name,language:t.language,primaryColor:a.theme.primaryColor,secondaryColor:a.theme.secondaryColor,accentColor:a.theme.accentColor,position:a.ui.position,chatWidth:a.ui.chatWidth,chatHeight:a.ui.chatHeight,autoOpen:a.ui.autoOpen.toString(),voiceEnabled:a.features.voiceEnabled.toString(),companyName:a.content.companyName,companyDescription:a.content.companyDescription,welcomeMessage:a.content.welcomeMessage,v:Date.now().toString()}).toString()}`}"><\/script>`,o=()=>{navigator.clipboard.writeText(s)};return e.jsx("div",{className:"mt-6 sm:mt-8",children:e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white mb-3 sm:mb-4",children:"Widget Integration Code"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"Copy and paste this script tag into your website's HTML. All your widget customizations are included in the URL."}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Script Tag"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"Live Configuration"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("code",{className:"common-bg-icons block w-full p-3 rounded-lg text-xs sm:text-sm font-mono text-slate-800 dark:text-white overflow-x-auto whitespace-pre-wrap max-h-64 overflow-y-auto",children:s}),e.jsx("button",{onClick:o,className:"absolute top-2 right-2 p-2 common-bg-icons rounded-md hover:shadow-sm transition-all touch-manipulation min-h-[36px] min-w-[36px] bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm",title:"Copy embed code",children:e.jsx(Ue,{className:"w-4 h-4 text-slate-600 dark:text-slate-300"})})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"ðŸš€ Live Features Included:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1",children:[e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["â€¢ Theme: ",a.theme.primaryColor]}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["â€¢ Position: ",a.ui.position]}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["â€¢ Voice: ",a.features.voiceEnabled?"Enabled":"Disabled"]}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["â€¢ Auto-open: ",a.ui.autoOpen?"Yes":"No"]}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["â€¢ Company: ",a.content.companyName]}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["â€¢ Size: ",a.ui.chatWidth," x ",a.ui.chatHeight]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"ðŸ“‹ Quick Installation:"}),e.jsxs("ol",{className:"text-xs text-slate-600 dark:text-slate-400 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Copy the script tag above"}),e.jsx("li",{children:"Paste it in your website's HTML, before the closing </body> tag"}),e.jsx("li",{children:"The widget will load automatically with all your custom settings"}),e.jsx("li",{children:"To update: copy new script when you change settings"})]}),e.jsx("div",{className:"mt-3 p-2 bg-green-50 dark:bg-green-900/20 rounded border border-green-200 dark:border-green-800",children:e.jsxs("p",{className:"text-xs text-green-800 dark:text-green-200",children:["âœ¨ ",e.jsx("strong",{children:"Simple & Clean:"})," Just one script tag with all your settings included in the URL!"]})})]})]})]})})})};var He={},Bt={exports:{}},Vs="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ys=Vs,qs=Ys;function Ot(){}function Ut(){}Ut.resetWarningCache=Ot;var Xs=function(){function t(r,s,o,i,c,m){if(m!==qs){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function a(){return t}var l={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:a,element:t,elementType:t,instanceOf:a,node:t,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:Ut,resetWarningCache:Ot};return l.PropTypes=l,l};Bt.exports=Xs();var Ft=Bt.exports,zt={L:1,M:0,Q:3,H:2},Ht={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},Zs=Ht;function Kt(t){this.mode=Zs.MODE_8BIT_BYTE,this.data=t}Kt.prototype={getLength:function(t){return this.data.length},write:function(t){for(var a=0;a<this.data.length;a++)t.put(this.data.charCodeAt(a),8)}};var ea=Kt,Be=zt;function oe(t,a){this.totalCount=t,this.dataCount=a}oe.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];oe.getRSBlocks=function(t,a){var l=oe.getRsBlockTable(t,a);if(l==null)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+a);for(var r=l.length/3,s=new Array,o=0;o<r;o++)for(var i=l[o*3+0],c=l[o*3+1],m=l[o*3+2],u=0;u<i;u++)s.push(new oe(c,m));return s};oe.getRsBlockTable=function(t,a){switch(a){case Be.L:return oe.RS_BLOCK_TABLE[(t-1)*4+0];case Be.M:return oe.RS_BLOCK_TABLE[(t-1)*4+1];case Be.Q:return oe.RS_BLOCK_TABLE[(t-1)*4+2];case Be.H:return oe.RS_BLOCK_TABLE[(t-1)*4+3];default:return}};var ta=oe;function Wt(){this.buffer=new Array,this.length=0}Wt.prototype={get:function(t){var a=Math.floor(t/8);return(this.buffer[a]>>>7-t%8&1)==1},put:function(t,a){for(var l=0;l<a;l++)this.putBit((t>>>a-l-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(t){var a=Math.floor(this.length/8);this.buffer.length<=a&&this.buffer.push(0),t&&(this.buffer[a]|=128>>>this.length%8),this.length++}};var sa=Wt,te={glog:function(t){if(t<1)throw new Error("glog("+t+")");return te.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return te.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var B=0;B<8;B++)te.EXP_TABLE[B]=1<<B;for(var B=8;B<256;B++)te.EXP_TABLE[B]=te.EXP_TABLE[B-4]^te.EXP_TABLE[B-5]^te.EXP_TABLE[B-6]^te.EXP_TABLE[B-8];for(var B=0;B<255;B++)te.LOG_TABLE[te.EXP_TABLE[B]]=B;var Gt=te,fe=Gt;function ze(t,a){if(t.length==null)throw new Error(t.length+"/"+a);for(var l=0;l<t.length&&t[l]==0;)l++;this.num=new Array(t.length-l+a);for(var r=0;r<t.length-l;r++)this.num[r]=t[r+l]}ze.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var a=new Array(this.getLength()+t.getLength()-1),l=0;l<this.getLength();l++)for(var r=0;r<t.getLength();r++)a[l+r]^=fe.gexp(fe.glog(this.get(l))+fe.glog(t.get(r)));return new ze(a,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var a=fe.glog(this.get(0))-fe.glog(t.get(0)),l=new Array(this.getLength()),r=0;r<this.getLength();r++)l[r]=this.get(r);for(var r=0;r<t.getLength();r++)l[r]^=fe.gexp(fe.glog(t.get(r))+a);return new ze(l,0).mod(t)}};var Qt=ze,V=Ht,Mt=Qt,aa=Gt,xe={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},_={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var a=t<<10;_.getBCHDigit(a)-_.getBCHDigit(_.G15)>=0;)a^=_.G15<<_.getBCHDigit(a)-_.getBCHDigit(_.G15);return(t<<10|a)^_.G15_MASK},getBCHTypeNumber:function(t){for(var a=t<<12;_.getBCHDigit(a)-_.getBCHDigit(_.G18)>=0;)a^=_.G18<<_.getBCHDigit(a)-_.getBCHDigit(_.G18);return t<<12|a},getBCHDigit:function(t){for(var a=0;t!=0;)a++,t>>>=1;return a},getPatternPosition:function(t){return _.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,a,l){switch(t){case xe.PATTERN000:return(a+l)%2==0;case xe.PATTERN001:return a%2==0;case xe.PATTERN010:return l%3==0;case xe.PATTERN011:return(a+l)%3==0;case xe.PATTERN100:return(Math.floor(a/2)+Math.floor(l/3))%2==0;case xe.PATTERN101:return a*l%2+a*l%3==0;case xe.PATTERN110:return(a*l%2+a*l%3)%2==0;case xe.PATTERN111:return(a*l%3+(a+l)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var a=new Mt([1],0),l=0;l<t;l++)a=a.multiply(new Mt([1,aa.gexp(l)],0));return a},getLengthInBits:function(t,a){if(1<=a&&a<10)switch(t){case V.MODE_NUMBER:return 10;case V.MODE_ALPHA_NUM:return 9;case V.MODE_8BIT_BYTE:return 8;case V.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(a<27)switch(t){case V.MODE_NUMBER:return 12;case V.MODE_ALPHA_NUM:return 11;case V.MODE_8BIT_BYTE:return 16;case V.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else if(a<41)switch(t){case V.MODE_NUMBER:return 14;case V.MODE_ALPHA_NUM:return 13;case V.MODE_8BIT_BYTE:return 16;case V.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}else throw new Error("type:"+a)},getLostPoint:function(t){for(var a=t.getModuleCount(),l=0,r=0;r<a;r++)for(var s=0;s<a;s++){for(var o=0,i=t.isDark(r,s),c=-1;c<=1;c++)if(!(r+c<0||a<=r+c))for(var m=-1;m<=1;m++)s+m<0||a<=s+m||c==0&&m==0||i==t.isDark(r+c,s+m)&&o++;o>5&&(l+=3+o-5)}for(var r=0;r<a-1;r++)for(var s=0;s<a-1;s++){var u=0;t.isDark(r,s)&&u++,t.isDark(r+1,s)&&u++,t.isDark(r,s+1)&&u++,t.isDark(r+1,s+1)&&u++,(u==0||u==4)&&(l+=3)}for(var r=0;r<a;r++)for(var s=0;s<a-6;s++)t.isDark(r,s)&&!t.isDark(r,s+1)&&t.isDark(r,s+2)&&t.isDark(r,s+3)&&t.isDark(r,s+4)&&!t.isDark(r,s+5)&&t.isDark(r,s+6)&&(l+=40);for(var s=0;s<a;s++)for(var r=0;r<a-6;r++)t.isDark(r,s)&&!t.isDark(r+1,s)&&t.isDark(r+2,s)&&t.isDark(r+3,s)&&t.isDark(r+4,s)&&!t.isDark(r+5,s)&&t.isDark(r+6,s)&&(l+=40);for(var d=0,s=0;s<a;s++)for(var r=0;r<a;r++)t.isDark(r,s)&&d++;var w=Math.abs(100*d/a/a-50)/5;return l+=w*10,l}},ra=_,na=ea,Jt=ta,Vt=sa,ue=ra,la=Qt;function ie(t,a){this.typeNumber=t,this.errorCorrectLevel=a,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var G=ie.prototype;G.addData=function(t){var a=new na(t);this.dataList.push(a),this.dataCache=null};G.isDark=function(t,a){if(t<0||this.moduleCount<=t||a<0||this.moduleCount<=a)throw new Error(t+","+a);return this.modules[t][a]};G.getModuleCount=function(){return this.moduleCount};G.make=function(){if(this.typeNumber<1){var t=1;for(t=1;t<40;t++){for(var a=Jt.getRSBlocks(t,this.errorCorrectLevel),l=new Vt,r=0,s=0;s<a.length;s++)r+=a[s].dataCount;for(var s=0;s<this.dataList.length;s++){var o=this.dataList[s];l.put(o.mode,4),l.put(o.getLength(),ue.getLengthInBits(o.mode,t)),o.write(l)}if(l.getLengthInBits()<=r*8)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())};G.makeImpl=function(t,a){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var l=0;l<this.moduleCount;l++){this.modules[l]=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++)this.modules[l][r]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,a),this.typeNumber>=7&&this.setupTypeNumber(t),this.dataCache==null&&(this.dataCache=ie.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,a)};G.setupPositionProbePattern=function(t,a){for(var l=-1;l<=7;l++)if(!(t+l<=-1||this.moduleCount<=t+l))for(var r=-1;r<=7;r++)a+r<=-1||this.moduleCount<=a+r||(0<=l&&l<=6&&(r==0||r==6)||0<=r&&r<=6&&(l==0||l==6)||2<=l&&l<=4&&2<=r&&r<=4?this.modules[t+l][a+r]=!0:this.modules[t+l][a+r]=!1)};G.getBestMaskPattern=function(){for(var t=0,a=0,l=0;l<8;l++){this.makeImpl(!0,l);var r=ue.getLostPoint(this);(l==0||t>r)&&(t=r,a=l)}return a};G.createMovieClip=function(t,a,l){var r=t.createEmptyMovieClip(a,l),s=1;this.make();for(var o=0;o<this.modules.length;o++)for(var i=o*s,c=0;c<this.modules[o].length;c++){var m=c*s,u=this.modules[o][c];u&&(r.beginFill(0,100),r.moveTo(m,i),r.lineTo(m+s,i),r.lineTo(m+s,i+s),r.lineTo(m,i+s),r.endFill())}return r};G.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)this.modules[t][6]==null&&(this.modules[t][6]=t%2==0);for(var a=8;a<this.moduleCount-8;a++)this.modules[6][a]==null&&(this.modules[6][a]=a%2==0)};G.setupPositionAdjustPattern=function(){for(var t=ue.getPatternPosition(this.typeNumber),a=0;a<t.length;a++)for(var l=0;l<t.length;l++){var r=t[a],s=t[l];if(this.modules[r][s]==null)for(var o=-2;o<=2;o++)for(var i=-2;i<=2;i++)o==-2||o==2||i==-2||i==2||o==0&&i==0?this.modules[r+o][s+i]=!0:this.modules[r+o][s+i]=!1}};G.setupTypeNumber=function(t){for(var a=ue.getBCHTypeNumber(this.typeNumber),l=0;l<18;l++){var r=!t&&(a>>l&1)==1;this.modules[Math.floor(l/3)][l%3+this.moduleCount-8-3]=r}for(var l=0;l<18;l++){var r=!t&&(a>>l&1)==1;this.modules[l%3+this.moduleCount-8-3][Math.floor(l/3)]=r}};G.setupTypeInfo=function(t,a){for(var l=this.errorCorrectLevel<<3|a,r=ue.getBCHTypeInfo(l),s=0;s<15;s++){var o=!t&&(r>>s&1)==1;s<6?this.modules[s][8]=o:s<8?this.modules[s+1][8]=o:this.modules[this.moduleCount-15+s][8]=o}for(var s=0;s<15;s++){var o=!t&&(r>>s&1)==1;s<8?this.modules[8][this.moduleCount-s-1]=o:s<9?this.modules[8][15-s-1+1]=o:this.modules[8][15-s-1]=o}this.modules[this.moduleCount-8][8]=!t};G.mapData=function(t,a){for(var l=-1,r=this.moduleCount-1,s=7,o=0,i=this.moduleCount-1;i>0;i-=2)for(i==6&&i--;;){for(var c=0;c<2;c++)if(this.modules[r][i-c]==null){var m=!1;o<t.length&&(m=(t[o]>>>s&1)==1);var u=ue.getMask(a,r,i-c);u&&(m=!m),this.modules[r][i-c]=m,s--,s==-1&&(o++,s=7)}if(r+=l,r<0||this.moduleCount<=r){r-=l,l=-l;break}}};ie.PAD0=236;ie.PAD1=17;ie.createData=function(t,a,l){for(var r=Jt.getRSBlocks(t,a),s=new Vt,o=0;o<l.length;o++){var i=l[o];s.put(i.mode,4),s.put(i.getLength(),ue.getLengthInBits(i.mode,t)),i.write(s)}for(var c=0,o=0;o<r.length;o++)c+=r[o].dataCount;if(s.getLengthInBits()>c*8)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+c*8+")");for(s.getLengthInBits()+4<=c*8&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=c*8||(s.put(ie.PAD0,8),s.getLengthInBits()>=c*8));)s.put(ie.PAD1,8);return ie.createBytes(s,r)};ie.createBytes=function(t,a){for(var l=0,r=0,s=0,o=new Array(a.length),i=new Array(a.length),c=0;c<a.length;c++){var m=a[c].dataCount,u=a[c].totalCount-m;r=Math.max(r,m),s=Math.max(s,u),o[c]=new Array(m);for(var d=0;d<o[c].length;d++)o[c][d]=255&t.buffer[d+l];l+=m;var w=ue.getErrorCorrectPolynomial(u),f=new la(o[c],w.getLength()-1),k=f.mod(w);i[c]=new Array(w.getLength()-1);for(var d=0;d<i[c].length;d++){var A=d+k.getLength()-i[c].length;i[c][d]=A>=0?k.get(A):0}}for(var D=0,d=0;d<a.length;d++)D+=a[d].totalCount;for(var y=new Array(D),h=0,d=0;d<r;d++)for(var c=0;c<a.length;c++)d<o[c].length&&(y[h++]=o[c][d]);for(var d=0;d<s;d++)for(var c=0;c<a.length;c++)d<i[c].length&&(y[h++]=i[c][d]);return y};var oa=ie,lt={};Object.defineProperty(lt,"__esModule",{value:!0});var ia=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var l=arguments[a];for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r])}return t},ca=Ft,Y=qt(ca),Yt=g,Oe=qt(Yt);function qt(t){return t&&t.__esModule?t:{default:t}}function da(t,a){var l={};for(var r in t)a.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(l[r]=t[r]);return l}var ma={bgColor:Y.default.oneOfType([Y.default.object,Y.default.string]).isRequired,bgD:Y.default.string.isRequired,fgColor:Y.default.oneOfType([Y.default.object,Y.default.string]).isRequired,fgD:Y.default.string.isRequired,size:Y.default.number.isRequired,title:Y.default.string,viewBoxSize:Y.default.number.isRequired,xmlns:Y.default.string},ot=(0,Yt.forwardRef)(function(t,a){var l=t.bgColor,r=t.bgD,s=t.fgD,o=t.fgColor,i=t.size,c=t.title,m=t.viewBoxSize,u=t.xmlns,d=u===void 0?"http://www.w3.org/2000/svg":u,w=da(t,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return Oe.default.createElement("svg",ia({},w,{height:i,ref:a,viewBox:"0 0 "+m+" "+m,width:i,xmlns:d}),c?Oe.default.createElement("title",null,c):null,Oe.default.createElement("path",{d:r,fill:l}),Oe.default.createElement("path",{d:s,fill:o}))});ot.displayName="QRCodeSvg";ot.propTypes=ma;lt.default=ot;Object.defineProperty(He,"__esModule",{value:!0});He.QRCode=void 0;var xa=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var l=arguments[a];for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r])}return t},ua=Ft,de=Se(ua),ha=zt,ga=Se(ha),pa=oa,fa=Se(pa),Xt=g,ba=Se(Xt),va=lt,wa=Se(va);function Se(t){return t&&t.__esModule?t:{default:t}}function ja(t,a){var l={};for(var r in t)a.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(l[r]=t[r]);return l}var ya={bgColor:de.default.oneOfType([de.default.object,de.default.string]),fgColor:de.default.oneOfType([de.default.object,de.default.string]),level:de.default.string,size:de.default.number,value:de.default.string.isRequired},Ke=(0,Xt.forwardRef)(function(t,a){var l=t.bgColor,r=l===void 0?"#FFFFFF":l,s=t.fgColor,o=s===void 0?"#000000":s,i=t.level,c=i===void 0?"L":i,m=t.size,u=m===void 0?256:m,d=t.value,w=ja(t,["bgColor","fgColor","level","size","value"]),f=new fa.default(-1,ga.default[c]);f.addData(d),f.make();var k=f.modules;return ba.default.createElement(wa.default,xa({},w,{bgColor:r,bgD:k.map(function(A,D){return A.map(function(y,h){return y?"":"M "+h+" "+D+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:o,fgD:k.map(function(A,D){return A.map(function(y,h){return y?"M "+h+" "+D+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:a,size:u,viewBoxSize:k.length}))});He.QRCode=Ke;Ke.displayName="QRCode";Ke.propTypes=ya;var ka=He.default=Ke;const Na=({agent:t,onClose:a})=>{const l=`https://widget.callshivai.com/agent/${t.id}`,[r,s]=yt.useState(180);yt.useEffect(()=>{const m=()=>{window.innerWidth<640?s(140):window.innerWidth<1024?s(160):s(180)},u=d=>{d.key==="Escape"&&a()};return m(),window.addEventListener("resize",m),window.addEventListener("keydown",u),()=>{window.removeEventListener("resize",m),window.removeEventListener("keydown",u)}},[a]);const o=()=>{const m=document.getElementById("qr-code-svg");if(!m)return;const u=document.createElement("canvas"),d=u.getContext("2d");if(!d)return;const w=new XMLSerializer().serializeToString(m),f=window.URL||window.webkitURL||window,k=new Image,A=new Blob([w],{type:"image/svg+xml;charset=utf-8"}),D=f.createObjectURL(A);k.onload=()=>{u.width=512,u.height=512,d.fillStyle="#ffffff",d.fillRect(0,0,u.width,u.height),d.drawImage(k,0,0,u.width,u.height),f.revokeObjectURL(D);const y=document.createElement("a");y.download=`${t.name}-qr-code.png`,y.href=u.toDataURL(),y.click()},k.src=D},i=()=>{navigator.clipboard.writeText(l);const m=document.getElementById("copy-url-btn");if(m){const u=m.innerHTML;m.innerHTML=`
        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
        </svg>
        Copied!
      `,setTimeout(()=>{m.innerHTML=u},2e3)}},c=m=>{m.target===m.currentTarget&&a()};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-3 sm:p-4 -top-8",onClick:c,children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-lg sm:max-w-2xl lg:max-w-4xl max-h-[90vh] overflow-y-auto relative border border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:a,className:"absolute top-3 right-3 sm:top-4 sm:right-4 p-2 hover:bg-slate-100 dark:hover:bg-slate-700 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm rounded-lg transition-colors z-50 cursor-pointer",children:e.jsx(nt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-500 dark:text-slate-400"})}),e.jsx("div",{className:"bg-gradient-to-r from-gray-400 via-gray-500 to-gray-600 px-4 sm:px-6 py-4 text-white relative overflow-hidden",children:e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-sm rounded-lg flex items-center justify-center",children:e.jsx(_t,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold",children:"Share Agent"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Scan to start conversation"})]})]})})}),e.jsxs("div",{className:"flex flex-col lg:grid lg:grid-cols-5 lg:gap-6 p-4 sm:p-6",children:[e.jsx("div",{className:"lg:col-span-2 flex justify-center mb-6 lg:mb-0",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-6 flex items-center justify-center shadow-lg border-2 border-slate-100 dark:border-slate-700 relative max-w-xs sm:max-w-none",children:[e.jsxs("div",{className:"relative bg-white p-3 sm:p-4 rounded-lg shadow-inner",children:[e.jsx("div",{className:"bg-white p-2 sm:p-3 rounded-lg border border-slate-100",children:e.jsx(ka,{id:"qr-code-svg",value:l,size:r,style:{height:"auto",maxWidth:"100%",width:"100%"},viewBox:"0 0 256 256",bgColor:"#ffffff",fgColor:"#000000",level:"M"})}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg p-1.5 shadow-xl border-2 border-white",children:e.jsxs("div",{className:"w-4 h-4 sm:w-5 sm:h-5 bg-gradient-to-br from-gray-500 to-gray-600 rounded-md flex items-center justify-center shadow-md relative overflow-hidden",children:[e.jsx("span",{className:"text-white font-bold text-xs relative z-10",children:"AI"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent"})]})})]}),e.jsx("div",{className:"absolute top-2 left-2 w-3 h-3 border-l-2 border-t-2 border-gray-400 rounded-tl-md"}),e.jsx("div",{className:"absolute top-2 right-2 w-3 h-3 border-r-2 border-t-2 border-gray-400 rounded-tr-md"}),e.jsx("div",{className:"absolute bottom-2 left-2 w-3 h-3 border-l-2 border-b-2 border-gray-400 rounded-bl-md"}),e.jsx("div",{className:"absolute bottom-2 right-2 w-3 h-3 border-r-2 border-b-2 border-gray-400 rounded-br-md"})]})}),e.jsxs("div",{className:"lg:col-span-3 flex flex-col justify-between",children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-slate-900/50 dark:to-gray-800/20 rounded-xl p-4 sm:p-5 border border-slate-200 dark:border-slate-700 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-gray-400 to-gray-500 rounded-lg flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx("span",{className:"text-white font-bold text-lg",children:t.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-white text-base sm:text-lg truncate",children:t.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold ${t.status==="Published"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":t.status==="Training"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-1.5 ${t.status==="Published"?"bg-green-500":t.status==="Training"?"bg-yellow-500":"bg-slate-500"}`}),t.status]})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-3 border border-slate-200 dark:border-slate-600",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs font-medium mb-1 uppercase tracking-wide",children:"Widget URL"}),e.jsx("p",{className:"font-mono text-xs sm:text-sm text-gray-600 dark:text-gray-400 break-all bg-gray-100 dark:bg-gray-800/20 px-2 py-1.5 rounded",children:l})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:o,className:"group bg-gradient-to-r from-gray-500 to-gray-600 hover:from-gray-600 hover:to-gray-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-2 touch-manipulation",children:[e.jsx("div",{className:"w-4 h-4 transition-transform group-hover:scale-110",children:e.jsxs("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"}),e.jsx("polyline",{points:"14,2 14,8 20,8"}),e.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),e.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),e.jsx("polyline",{points:"10,9 9,9 8,9"})]})}),e.jsx("span",{className:"text-sm sm:text-base",children:"Download QR"})]}),e.jsxs("button",{id:"copy-url-btn",onClick:i,className:"group bg-white hover:bg-slate-50 dark:bg-slate-700 dark:hover:bg-slate-600 text-slate-700 dark:text-slate-200 font-semibold py-3 px-4 rounded-lg transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.02] active:scale-[0.98] border-2 border-slate-200 dark:border-slate-600 flex items-center justify-center gap-2 touch-manipulation",children:[e.jsx("div",{className:"w-4 h-4 transition-transform group-hover:scale-110",children:e.jsx("svg",{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("span",{className:"text-sm sm:text-base",children:"Copy Link"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs sm:text-sm leading-relaxed",children:"Share this QR code or link to let users instantly chat with your AI agent"})})]})]})]})})},Ca=({session:t,onClose:a})=>{var w;const[l,r]=g.useState([]),[s,o]=g.useState(!0),[i,c]=g.useState(null);if(g.useEffect(()=>{(async()=>{if(t!=null&&t.session_id){o(!0),c(null);try{const k=await It.getSessionTranscripts(t.session_id);r(k.transcripts||[])}catch(k){console.error("Failed to fetch transcripts:",k),c(k.message||"Failed to load transcripts")}finally{o(!1)}}})()},[t==null?void 0:t.session_id]),!t)return null;const m=f=>{if(!f)return"0m 0s";const k=Math.floor(f/60),A=Math.floor(f%60);return`${k}m ${A}s`},u=f=>f?new Date(f).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A",d=f=>f?new Date(f).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e.jsx("div",{className:"fixed inset-0 -top-8 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl sm:rounded-2xl shadow-2xl w-full max-w-3xl max-h-[95vh] sm:max-h-[90vh] overflow-hidden flex flex-col my-auto",children:[e.jsxs("div",{className:"p-3 sm:p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 common-bg-icons rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(le,{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-600 dark:text-slate-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white truncate",children:"Session Transcript"}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate",children:["ID: ",t.session_id||t.id]})]})]}),e.jsx("button",{onClick:a,className:"p-1.5 sm:p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors flex-shrink-0",children:e.jsx(nt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-600 dark:text-slate-400"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs sm:text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(Ms,{className:"w-3 h-3 sm:w-4 sm:h-4 text-slate-500 dark:text-slate-400 flex-shrink-0"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-400 truncate",children:((w=t.location)==null?void 0:w.city)||t.user_ip||"unknown"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(Rs,{className:"w-3 h-3 sm:w-4 sm:h-4 text-slate-500 dark:text-slate-400 flex-shrink-0"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-400 truncate",children:t.start_time?new Date(t.start_time).toLocaleDateString():"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 min-w-0",children:[e.jsx(be,{className:"w-3 h-3 sm:w-4 sm:h-4 text-slate-500 dark:text-slate-400 flex-shrink-0"}),e.jsx("span",{className:"text-slate-600 dark:text-slate-400 truncate",children:m(t.duration_seconds)})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 sm:p-4 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"common-bg-icons p-3 sm:p-4 rounded-lg sm:rounded-xl",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-slate-800 dark:text-white mb-3",children:"Conversation Transcript"}),e.jsx("div",{className:"space-y-1 max-h-[250px] sm:max-h-[400px] overflow-y-auto",children:s?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Is,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-500 animate-spin"})}):i?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ct,{className:"w-10 h-10 sm:w-12 sm:h-12 text-red-300 dark:text-red-600 mx-auto mb-3"}),e.jsx("p",{className:"text-xs sm:text-sm text-red-500 dark:text-red-400",children:i})]}):l&&l.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs sm:text-sm text-slate-500 dark:text-slate-400 mb-2",children:["Conversation started at ",d(t.start_time)]}),l.map((f,k)=>e.jsx("div",{className:"flex flex-col gap-1.5 py-1.5 sm:py-2",children:f.role==="user"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-start gap-1.5 sm:gap-2 flex-1",children:[e.jsxs("div",{className:"flex-1 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-2xl rounded-tr-sm px-3 py-2 sm:px-4 sm:py-3 shadow-sm",children:[e.jsx("p",{className:"text-xs sm:text-sm",children:f.text||f.content}),e.jsxs("span",{className:"text-xs opacity-75 mt-1 block",children:["CUSTOMER â€¢ ",u(f.timestamp||f.created_at)]})]}),e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gradient-to-br from-slate-600 to-slate-700 flex items-center justify-center flex-shrink-0",children:e.jsx(Fe,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-white"})})]})]}):e.jsxs("div",{className:"flex items-start gap-1.5 sm:gap-2 flex-1",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center flex-shrink-0",children:e.jsx(le,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-white"})}),e.jsxs("div",{className:"flex-1 common-bg-icons rounded-2xl rounded-tl-sm px-3 py-2 sm:px-4 sm:py-3 border border-slate-200 dark:border-slate-700",children:[e.jsx("p",{className:"text-xs sm:text-sm text-slate-800 dark:text-white",children:f.text||f.content}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1 block",children:["SHIVAI ASSISTANT â€¢ ",u(f.timestamp||f.created_at)]})]}),e.jsx("div",{className:"flex-1"})]})},k)),e.jsxs("p",{className:"text-xs text-slate-400 dark:text-slate-500 mt-3 flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),"Session ended â€¢ Resolution: Session completed"]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ct,{className:"w-10 h-10 sm:w-12 sm:h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-500 dark:text-slate-400",children:"No transcripts available for this session"})]})})]}),e.jsxs("div",{className:"common-bg-icons p-3 sm:p-4 rounded-lg sm:rounded-xl",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-slate-800 dark:text-white mb-3",children:"Session Details"}),e.jsxs("button",{className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})}),e.jsx("span",{className:"text-sm font-medium",children:"Play Recording"})]})]})]})]})})};class Sa{constructor(){me(this,"room",null);me(this,"isConnected",!1);me(this,"isConnecting",!1);me(this,"callbacks",null);me(this,"lastSentMessage",null);me(this,"localAudioTrack",null);me(this,"remoteAudioTrack",null)}async loadLiveKitSDK(){return new Promise((a,l)=>{if(window.LivekitClient!==void 0){console.log("âœ… LiveKit already loaded"),a();return}console.log("ðŸ“¦ Loading LiveKit SDK...");const r=document.createElement("script");r.src="https://unpkg.com/livekit-client@latest/dist/livekit-client.umd.js",r.onload=()=>{console.log("âœ… LiveKit client loaded successfully"),a()},r.onerror=()=>{console.error("âŒ Failed to load LiveKit client"),l(new Error("Failed to load LiveKit client"))},document.head.appendChild(r)})}setCallbacks(a){this.callbacks=a}async connect(a,l="en-US"){var r,s,o,i,c,m,u;console.log("ðŸš€ LiveKit Service: Starting connection process..."),console.log("ðŸ“ Connection parameters:",{agentId:a,language:l});try{if(this.isConnecting||this.isConnected){console.log("âš ï¸ Already connecting or connected");return}if(console.log("ðŸ“Š Initial state:",{isConnecting:this.isConnecting,isConnected:this.isConnected,hasRoom:!!this.room,hasCallbacks:!!this.callbacks}),this.isConnecting=!0,console.log("ðŸ”„ Set isConnecting to true"),(r=this.callbacks)==null||r.onStatusUpdate("Loading LiveKit...","connecting"),console.log("ðŸ” Checking LiveKit SDK availability..."),window.LivekitClient===void 0){if(console.log("ðŸ“¦ LiveKit not loaded, loading now..."),await this.loadLiveKitSDK(),console.log("âœ… LiveKit loaded successfully"),window.LivekitClient===void 0)throw console.error("âŒ LiveKit still not available after loading"),new Error("LiveKit not available after loading")}else console.log("âœ… LiveKit SDK already available");if(console.log("ðŸ” LiveKit version info:",{hasLiveKit:!!window.LivekitClient,version:((s=window.LivekitClient)==null?void 0:s.version)||"unknown"}),(o=this.callbacks)==null||o.onStatusUpdate("Connecting...","connecting"),!this.isConnecting){console.log("âŒ Connection cancelled before token request");return}const d=/Mobile|Android|iPhone/i.test(navigator.userAgent)?"mobile":"desktop";console.log("ðŸ“± Device type detected:",d);const w=`call_${Date.now()}`;console.log("ðŸ”‘ Getting token with parameters:",{agent_id:a,language:l,call_id:w,device:d,user_agent:navigator.userAgent}),console.log("ðŸŒ Making request to token server...");const f=await fetch("https://python.service.callshivai.com/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_id:a,language:l,call_id:w,device:d,user_agent:navigator.userAgent})});if(console.log("ðŸ“¡ Token server response:",{status:f.status,statusText:f.statusText,ok:f.ok,headers:Object.fromEntries(f.headers.entries())}),!f.ok){const h=await f.text();throw console.error("âŒ Token server error details:",h),new Error(`Failed to get LiveKit token: ${f.status} - ${h}`)}const k=await f.json();if(console.log("âœ… [LiveKit] Token received successfully:",{hasUrl:!!k.url,hasToken:!!k.token,urlLength:((i=k.url)==null?void 0:i.length)||0,tokenLength:((c=k.token)==null?void 0:c.length)||0}),!this.isConnecting){console.log("âŒ Connection cancelled after token received");return}window.pendingAudioElement&&(console.log("ðŸ”Š Handling pending audio element..."),window.pendingAudioElement.play().catch(h=>console.warn("âš ï¸ Still cannot play audio:",h)),window.pendingAudioElement=null);const A={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,suppressLocalAudioPlayback:!0,channelCount:1,sampleRate:48e3,sampleSize:16,volume:.5,latency:.1,facingMode:"user",deviceId:"default",googEchoCancellation:!0,googAutoGainControl:!0,googNoiseSuppression:!0,googHighpassFilter:!0,googAudioMirroring:!1,googBeamforming:!1,googArrayGeometry:!1,mozAutoGainControl:!0,mozNoiseSuppression:!0};console.log("ðŸŽµ Audio configuration prepared:",A);const D=window.LivekitClient;console.log("ðŸ  Creating LiveKit room...");const y={adaptiveStream:!0,dynacast:!0,audioCaptureDefaults:{...A,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,suppressLocalAudioPlayback:!0},reconnectPolicy:{nextRetryDelayInMs:()=>2e3},publishDefaults:{audioPreset:D.AudioPresets.speech,dtx:!0,red:!1,simulcast:!1},e2eeEnabled:!1,expWebAudioMix:!1};if(console.log("ðŸ  Room configuration:",y),this.room=new D.Room(y),console.log("âœ… LiveKit room created successfully"),console.log("ðŸ‘‚ Setting up room event listeners..."),this.setupRoomEvents(D,A),console.log("ðŸ”— Connecting to LiveKit room with URL and token..."),console.log("ðŸ”— Connection details:",{url:k.url,tokenPreview:k.token.substring(0,20)+"..."}),await this.room.connect(k.url,k.token),console.log("ðŸ”— Room connected successfully"),!this.isConnecting){console.log("âŒ Connection cancelled during room connection"),this.room&&(this.room.disconnect(),this.room=null);return}console.log("ðŸŽ‰ Connection process completed successfully!")}catch(d){console.error("âŒ Connection Error:",d),this.isConnecting=!1,this.isConnected=!1;let w="Connection failed";d instanceof Error&&(d.message.includes("token")?w="Authentication failed":d.message.includes("timeout")?w="Connection timeout":d.message.includes("network")&&(w="Network error")),(m=this.callbacks)==null||m.onError(w),(u=this.callbacks)==null||u.onStatusUpdate(`âŒ ${w}`,"disconnected")}}setupRoomEvents(a,l){if(!this.room){console.error("âŒ Cannot setup room events: room is null");return}console.log("ðŸ‘‚ Setting up room event listeners..."),this.room.on(a.RoomEvent.TrackSubscribed,(r,s,o)=>{if(console.log("ðŸŽµ TrackSubscribed event:",{trackKind:r.kind,participant:o==null?void 0:o.identity,trackSid:r.sid}),r.kind===a.Track.Kind.Audio){console.log("ðŸ”Š Audio track subscribed, setting up playback...");const i=r.attach();if(i.volume=.4,i.preload="auto",i.autoplay=!0,i.setSinkId)try{i.setSinkId("default")}catch(c){console.warn("âš ï¸ Could not set audio sink:",c)}i.webkitAudioDecodedByteCount!==void 0&&(i.webkitPreservesPitch=!1),document.body.appendChild(i),i.play().catch(c=>{console.warn("âš ï¸ Audio autoplay blocked, will try on user interaction:",c),window.pendingAudioElement=i}),this.remoteAudioTrack=r,console.log("ðŸ”Š Agent audio track received with feedback prevention")}}),this.room.on(a.RoomEvent.ParticipantMetadataChanged,(r,s)=>{if(console.log("ðŸ“‹ Participant metadata changed:",{metadata:r,participant:s==null?void 0:s.identity}),r)try{const o=JSON.parse(r);(o.transcript||o.text)&&(this.addMessage(!1,o.transcript||o.text,"voice"),console.log("âœ… Transcript from participant metadata:",o.transcript||o.text))}catch{console.log("Metadata not JSON:",r)}}),this.room.on(a.RoomEvent.RoomMetadataChanged,r=>{if(console.log("ðŸ  Room metadata changed:",r),r)try{const s=JSON.parse(r);(s.transcript||s.text)&&(this.addMessage(!1,s.transcript||s.text,"voice"),console.log("âœ… Transcript from room metadata:",s.transcript||s.text))}catch{console.log("Room metadata not JSON:",r)}}),this.room.on(a.RoomEvent.Connected,async()=>{var s,o,i,c,m;console.log("ðŸŽ‰ Connected event fired! Room successfully connected"),console.log("ðŸ“Š Connection state after Connected event:",{isConnected:this.isConnected,isConnecting:this.isConnecting,roomState:(s=this.room)==null?void 0:s.state}),this.isConnected=!0,this.isConnecting=!1,console.log("ðŸ“Š Updated connection state:",{isConnected:this.isConnected,isConnecting:this.isConnecting}),(o=this.callbacks)==null||o.onStatusUpdate("ðŸ¤– AI is Initializing...","connected"),console.log("ðŸŽ¤ Attempting to enable microphone...");try{await this.room.localParticipant.setMicrophoneEnabled(!0,{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,suppressLocalAudioPlayback:!0,channelCount:1,sampleRate:48e3,sampleSize:16,volume:.5,latency:.1,facingMode:"user"}),console.log("âœ… Microphone enabled with optimized settings")}catch(u){console.warn("âš ï¸ Failed to enable microphone with full config, trying basic:",u);try{await this.room.localParticipant.setMicrophoneEnabled(!0),console.log("âœ… Microphone enabled (basic mode)")}catch(d){console.error("âŒ Failed to enable microphone completely:",d),(i=this.callbacks)==null||i.onError("Failed to enable microphone. Please check your microphone permissions and try again.")}}if(window.AudioContext||window.webkitAudioContext){console.log("ðŸ”Š Resuming audio context...");const u=window.AudioContext||window.webkitAudioContext,d=new u;d.state==="suspended"&&d.resume().then(()=>{console.log("ðŸ”Š Audio context resumed for better audio quality")}).catch(w=>console.warn("âš ï¸ Could not resume audio context:",w))}(c=this.callbacks)==null||c.onStatusUpdate("âœ… Connected - Speak now!","connected");const r=Array.from(this.room.localParticipant.audioTrackPublications.values());r.length>0&&(this.localAudioTrack=r[0].track,console.log("ðŸŽ¤ Audio track found and monitoring started immediately")),console.log("ðŸŽ¤ Microphone enabled and ready for conversation"),console.log("ðŸŽ‰ Firing onConnected callback..."),(m=this.callbacks)==null||m.onConnected(),console.log("âœ… Connection setup completed successfully!")}),this.room.on(a.RoomEvent.Disconnected,r=>{var s,o;console.log("ðŸ”´ Disconnected from LiveKit room:",r),this.isConnected=!1,(s=this.callbacks)==null||s.onDisconnected(r),(o=this.callbacks)==null||o.onStatusUpdate("âŒ Disconnected","disconnected")}),this.room.on(a.RoomEvent.ConnectionStateChanged,r=>{var s,o;console.log("ðŸ”— Connection state changed to:",r),(s=this.callbacks)==null||s.onConnectionStateChange(r),r===a.ConnectionState.Disconnected&&(console.log("ðŸ”´ Connection state is disconnected"),this.isConnected=!1,(o=this.callbacks)==null||o.onStatusUpdate("âŒ Disconnected","disconnected"))}),this.room.on(a.RoomEvent.DataReceived,(r,s,o,i)=>{var c,m;console.log("ðŸ“¨ DataReceived EVENT FIRED:",{payloadLength:r.length,participant:s==null?void 0:s.identity,kind:o,topic:i,timestamp:new Date().toLocaleTimeString()});try{const d=new TextDecoder().decode(r);if(console.log("ðŸ“ Raw decoded text:",d),d&&d.trim().length>0){let w=d.trim(),f=!1;const k=(s==null?void 0:s.identity)||"Agent";if(["subscribed","connected","disconnected","enabled","disabled","true","false","null","undefined"].some(y=>d.toLowerCase()===y)){console.log("ðŸš« Skipping obvious technical message:",d);return}console.log("ðŸŽ¯ Processing potential transcript:",d);try{const y=JSON.parse(d);console.log("ðŸ“‹ Parsed JSON data:",y);const h=["text","transcript","message","content","data","response","speech","voice","audio","words","result","output"];for(const H of h)if(y[H]&&typeof y[H]=="string"&&y[H].trim().length>0){w=y[H].trim(),f=!0,console.log(`âœ… Found text in field '${H}':`,w);break}let T=!1;if(y.role?T=y.role.includes("user")||y.role.includes("human"):y.speaker?T=y.speaker.includes("user")||y.speaker.includes("human")||y.speaker.includes("You"):s&&(T=s.identity===((c=this.room.localParticipant)==null?void 0:c.identity)),y.type==="transcript"&&y.text){y.role==="user"?y.type!=="chat"?this.addMessage(!0,y.text,"voice"):console.log("ðŸš« Skipping user chat message (already shown from sendMessage)"):y.role==="assistant"&&this.addMessage(!1,y.text,"voice"),console.log("âœ… Processed legacy format transcript");return}if(f){const H=T;(!T||T&&y.type!=="chat"||T&&y.source!=="typed")&&(this.addMessage(H,w,"voice"),console.log("âœ… Added JSON transcript:",{role:H?"user":"assistant",text:w.substring(0,50)+"..."}))}}catch{if(console.log("ðŸ“„ Not JSON, treating as plain text"),d.length>=2&&d.length<=1e3){const h=s&&s.identity===((m=this.room.localParticipant)==null?void 0:m.identity);this.addMessage(h,w,"voice"),console.log("âœ… Added plain text transcript:",{role:h?"user":"assistant",text:w.substring(0,50)+"..."})}}}}catch(u){console.error("âŒ Error processing DataReceived:",u)}});try{typeof this.room.registerTextStreamHandler=="function"?(console.log("ðŸ“ Registering text stream handlers..."),this.room.registerTextStreamHandler("lk.transcription",async(r,s)=>{var o,i,c,m;console.log("ðŸŽ¯ Transcription stream from:",s.identity);try{const u=r.info;console.log("Stream info:",{topic:u.topic,id:u.id,timestamp:u.timestamp,size:u.size,attributes:u.attributes});const d=((o=u.attributes)==null?void 0:o["lk.transcription_final"])==="true",w=(i=u.attributes)==null?void 0:i["lk.transcribed_track_id"],f=(c=u.attributes)==null?void 0:c["lk.segment_id"];console.log("Transcription attributes:",{isFinal:d,transcribedTrackId:w,segmentId:f});const k=await r.readAll();if(k&&k.trim()){const A=s.identity===((m=this.room.localParticipant)==null?void 0:m.identity);if(A&&this.lastSentMessage&&k.trim()===this.lastSentMessage.trim()){console.log("ðŸš« Skipping duplicate user message from transcription:",k);return}this.addMessage(A,k,"voice"),console.log("âœ… Transcription added:",{sender:A?"user":"assistant",text:k,isFinal:d})}}catch(u){console.error("âŒ Error processing transcription stream:",u)}}),this.room.registerTextStreamHandler("lk.chat",async(r,s)=>{var o;console.log("ðŸ’¬ Chat stream from:",s.identity);try{const i=await r.readAll();!(s.identity===((o=this.room.localParticipant)==null?void 0:o.identity))&&i&&i.trim()&&(console.log("ðŸ’¬ AI Chat response received:",i),this.addMessage(!1,i,"chat"),console.log("ðŸ’¬ Chat message added:",{sender:s.identity,text:i}))}catch(i){console.error("âŒ Error processing chat stream:",i)}}),console.log("âœ… Text stream handlers registered successfully")):console.warn("âš ï¸ registerTextStreamHandler not available, using fallback DataReceived")}catch(r){console.error("âŒ Error registering text stream handlers:",r)}}addMessage(a,l,r="voice"){if(!this.callbacks)return;const s={id:Date.now()+Math.random(),text:l.trim(),isUser:a,timestamp:new Date,source:r};this.callbacks.onMessage(s)}async sendMessage(a){var l;if(!this.room||!this.isConnected||!a.trim()){console.warn("âš ï¸ Cannot send message: not connected or empty message");return}try{if(console.log("ðŸ“¤ Sending chat message:",a),typeof this.room.localParticipant.sendText=="function")await this.room.localParticipant.sendText(a,{topic:"lk.chat"}),console.log("âœ… Chat sent with sendText");else{const r={type:"chat",text:a,timestamp:Date.now(),source:"typed"},o=new TextEncoder().encode(JSON.stringify(r));this.room.localParticipant.publishData(o,{reliable:!0}),console.log("âœ… Chat sent with publishData")}this.addMessage(!0,a,"chat"),this.lastSentMessage=a}catch(r){console.error("âŒ Error sending message:",r),(l=this.callbacks)==null||l.onError("Failed to send message")}}async disconnect(){if(this.room){this.isConnecting=!1,this.isConnected=!1;try{await this.room.disconnect(),console.log("ðŸ›‘ Disconnected from LiveKit room")}catch(a){console.error("âŒ Error disconnecting:",a)}this.room=null,this.localAudioTrack=null,this.remoteAudioTrack=null}}async toggleMute(){if(!this.room||!this.isConnected)return!1;try{const a=this.room.localParticipant.isMicrophoneEnabled;return await this.room.localParticipant.setMicrophoneEnabled(!a),console.log(`ðŸŽ¤ Microphone ${a?"muted":"enabled"}`),!a}catch(a){return console.error("âŒ Error toggling microphone:",a),!1}}getStatus(){return{isConnected:this.isConnected,isConnecting:this.isConnecting}}}const Rt=new Sa,ir=()=>{const{id:t}=Cs(),a=Ss(),l=Ts(),{agents:r,currentAgent:s,setCurrentAgent:o,addAgent:i,updateAgent:c,publishAgentStatus:m,unpublishAgentStatus:u}=Es(),{user:d}=Ls(),w=_s(d==null?void 0:d.email),f=l.pathname.includes("/create"),k=l.pathname.includes("/edit"),A=l.pathname.includes("/train"),D=t&&!k&&!A,y=!t&&!f,[h,T]=g.useState({name:"",gender:"Female",businessProcess:"",industry:"",persona:"Empathetic",language:"English (US)",voice:"Sarah - Professional",customInstructions:"",guardrailsLevel:"Medium",responseStyle:"Balanced",maxResponseLength:"Medium (150 words)",contextWindow:"Standard (8K tokens)",temperature:50}),[H,K]=g.useState(!1),[N,$]=g.useState(""),[b,se]=g.useState("all"),[We,Te]=g.useState(!1),[Ge,Ee]=g.useState(!1),[he,j]=g.useState("call"),[C,M]=g.useState(!1),[Q,ae]=g.useState(0),[it,Le]=g.useState(!1),[W,ye]=g.useState(null),[ct,q]=g.useState([{id:"1",text:`Hi! I'm ${(s==null?void 0:s.name)||"your AI assistant"}. How can I help you today?`,isUser:!1,timestamp:new Date}]),[Pe,Qe]=g.useState(""),F=g.useRef(new Set),dt=g.useRef(0),[ve,J]=g.useState(!1),[O,Ae]=g.useState(new Set),[ce,X]=g.useState("disconnected"),[Zt,Z]=g.useState("Ready to connect"),[ge,es]=g.useState(!1),[Ta,re]=g.useState("ðŸ“ž Ready to start call"),[Je,we]=g.useState(!1),[mt,ke]=g.useState(!1),[ne,Ve]=g.useState(null),[Ye,xt]=g.useState([]),[qe,ut]=g.useState(!1),[Xe,ht]=g.useState(null),[ts,ss]=g.useState(""),[as,rs]=g.useState("all"),[ns,ls]=g.useState("all"),[gt,pt]=g.useState(null);g.useEffect(()=>{const n={onMessage:x=>{q(v=>[...v,{id:String(x.id),text:x.text,isUser:x.isUser,timestamp:x.timestamp,source:x.source}])},onConnected:()=>{M(!0),X("connected"),Z("Connected - Speak now!"),J(!1)},onDisconnected:()=>{M(!1),X("disconnected"),Z("Disconnected"),J(!1),W&&(clearInterval(W),ye(null)),ae(0)},onConnectionStateChange:x=>{console.log("Connection state changed:",x)},onError:x=>{X("disconnected"),Z(x),J(!1),M(!1),console.error("LiveKit error:",x)},onStatusUpdate:(x,v)=>{Z(x),X(v)}};return Rt.setCallbacks(n),()=>{Rt.disconnect(),W&&clearInterval(W)}},[W]),g.useEffect(()=>{if(t&&!f){const n=r.find(x=>x.id===t);n&&(o(n),T({name:n.name,gender:"Female",businessProcess:"",industry:"",persona:n.persona,language:n.language,voice:n.voice,customInstructions:"",guardrailsLevel:"Medium",responseStyle:"Balanced",maxResponseLength:"Medium (150 words)",contextWindow:"Standard (8K tokens)",temperature:50}),q([]),Ze(n.id))}else f&&T({name:"",gender:"Female",businessProcess:"",industry:"",persona:"Empathetic",language:"English (US)",voice:"Sarah - Professional",customInstructions:"",guardrailsLevel:"Medium",responseStyle:"Balanced",maxResponseLength:"Medium (150 words)",contextWindow:"Standard (8K tokens)",temperature:50})},[t,f,r,o]);const Ze=async n=>{ut(!0),ht(null);try{const x=await It.getAgentSessions(n),v=(x==null?void 0:x.sessions)||[];xt(v),console.log("âœ… Session history loaded:",v.length,"sessions")}catch(x){console.error("âŒ Error fetching session history:",x),ht(x instanceof Error?x.message:"Failed to load session history"),xt([])}finally{ut(!1)}},De=[{value:"customer-support",label:"Customer Support",group:"Support"},{value:"sales-marketing",label:"Sales & Marketing",group:"Sales"},{value:"appointment-setting",label:"Appointment Setting",group:"Sales"},{value:"lead-qualification",label:"Lead Qualification",group:"Sales"},{value:"product-explanation",label:"Product Explanation",group:"Support"},{value:"order-processing",label:"Order Processing",group:"Operations"},{value:"technical-support",label:"Technical Support",group:"Support"},{value:"billing-inquiries",label:"Billing Inquiries",group:"Support"},{value:"feedback-collection",label:"Feedback Collection",group:"Operations"},{value:"onboarding",label:"Customer Onboarding",group:"Operations"}],et=[{value:"real-estate",label:"Real Estate"},{value:"healthcare",label:"Healthcare"},{value:"dental",label:"Dental"},{value:"fitness",label:"Fitness & Wellness"},{value:"education",label:"Education"},{value:"finance",label:"Finance & Banking"},{value:"insurance",label:"Insurance"},{value:"ecommerce",label:"E-commerce"},{value:"retail",label:"Retail"},{value:"technology",label:"Technology"},{value:"saas",label:"SaaS"},{value:"legal",label:"Legal Services"},{value:"consulting",label:"Consulting"},{value:"accounting",label:"Accounting"},{value:"hospitality",label:"Hospitality"},{value:"restaurants",label:"Restaurants"},{value:"automotive",label:"Automotive"},{value:"construction",label:"Construction"},{value:"manufacturing",label:"Manufacturing"},{value:"travel",label:"Travel & Tourism"},{value:"beauty",label:"Beauty & Salon"},{value:"home-services",label:"Home Services"},{value:"nonprofit",label:"Non-Profit"},{value:"government",label:"Government"},{value:"entertainment",label:"Entertainment"},{value:"other",label:"Other"}],os=[{value:"Female",label:"Female"},{value:"Male",label:"Male"},{value:"Non-binary",label:"Non-binary"},{value:"Other",label:"Other"}],is={"customer-support-real-estate":{name:"Real Estate Support Agent",description:"Handles property inquiries, scheduling viewings, and providing property information",features:["Property Search","Viewing Scheduling","Market Updates","Document Assistance"],persona:"Formal",customInstructions:"You are a knowledgeable real estate assistant. Help clients with property inquiries, schedule viewings, provide market insights, and assist with documentation. Always be professional and detail-oriented.",guardrailsLevel:"High"},"sales-marketing-healthcare":{name:"Healthcare Sales Assistant",description:"Promotes healthcare services, books consultations, and provides service information",features:["Service Promotion","Consultation Booking","Insurance Queries","Health Education"],persona:"Empathetic",customInstructions:"You are a caring healthcare sales assistant. Help patients understand services, book appointments, answer insurance questions, and provide health education. Always prioritize patient care and privacy.",guardrailsLevel:"High"},"appointment-setting-dental":{name:"Dental Appointment Scheduler",description:"Schedules dental appointments, handles cancellations, and provides dental care information",features:["Appointment Booking","Reminder Calls","Treatment Info","Insurance Verification"],persona:"Reassuring (Support)",customInstructions:"You are a friendly dental appointment scheduler. Help patients book appointments, provide treatment information, handle insurance verification, and ease dental anxiety with reassuring communication.",guardrailsLevel:"Medium"},"lead-qualification-saas":{name:"SaaS Lead Qualifier",description:"Qualifies software leads, demos features, and nurtures prospects through the sales funnel",features:["Lead Scoring","Demo Scheduling","Feature Explanation","Pricing Information"],persona:"Persuasive (Sales)",customInstructions:"You are a tech-savvy SaaS sales assistant. Qualify leads by understanding their needs, explain software features, schedule demos, and provide pricing information. Focus on value proposition and ROI.",guardrailsLevel:"Medium"}},ft=()=>{var x,v,E,p,P,S,L,z,U;const n=`${h.businessProcess}-${h.industry}`;return is[n]||{name:`${((x=De.find(I=>I.value===h.businessProcess))==null?void 0:x.label)||"Custom"} Agent`,description:`Handles ${((E=(v=De.find(I=>I.value===h.businessProcess))==null?void 0:v.label)==null?void 0:E.toLowerCase())||"various tasks"} for ${((P=(p=et.find(I=>I.value===h.industry))==null?void 0:p.label)==null?void 0:P.toLowerCase())||"your business"}`,features:["Customer Interaction","Query Resolution","Information Provision","Process Automation"],persona:"Friendly",customInstructions:`You are a professional AI assistant specializing in ${((L=(S=De.find(I=>I.value===h.businessProcess))==null?void 0:S.label)==null?void 0:L.toLowerCase())||"customer service"} for the ${((U=(z=et.find(I=>I.value===h.industry))==null?void 0:z.label)==null?void 0:U.toLowerCase())||"business"} industry. Provide helpful, accurate, and timely assistance to users.`,guardrailsLevel:"Medium"}},cs=()=>{const n=ft();T(x=>({...x,persona:n.persona,customInstructions:n.customInstructions,guardrailsLevel:n.guardrailsLevel})),K(!1)},ds=()=>{if(!h.name||h.name.trim()===""){alert("Agent name is required. Please enter a name for your agent.");return}f?(i({name:h.name,status:"Draft",persona:h.persona,language:h.language,voice:h.voice,stats:{conversations:0,successRate:0,avgResponseTime:0,activeUsers:0}}),a("/agents")):k&&s&&(c(s.id,{name:h.name,persona:h.persona,language:h.language,voice:h.voice}),a(`/agents/${s.id}`))},bt=async n=>{try{Ae(x=>new Set(x).add(n)),await m(n),console.log("âœ… Agent published successfully")}catch(x){console.error("âŒ Error publishing agent:",x),alert(x.message||"Failed to publish agent. Please try again.")}finally{Ae(x=>{const v=new Set(x);return v.delete(n),v})}},Me=async n=>{try{Ae(x=>new Set(x).add(n)),await u(n),console.log("âœ… Agent paused successfully")}catch(x){console.error("âŒ Error pausing agent:",x),alert(x.message||"Failed to pause agent. Please try again.")}finally{Ae(x=>{const v=new Set(x);return v.delete(n),v})}},vt=async()=>{if(!Pe.trim()||ve)return;const n=Pe.trim(),x=Date.now();if(x-dt.current<1e3){console.log("ðŸš« Message sent too quickly, preventing duplicate");return}const v=`user-${n}-${Math.floor(x/1e3)}`;if(F.current.has(v)){console.log("ðŸš« Duplicate message prevented:",n),Qe("");return}F.current.add(v),dt.current=x,setTimeout(()=>{F.current.delete(v)},1e4),Qe(""),J(!0);try{const E={id:`user-chat-${x}-${Math.random()}`,text:n,isUser:!0,timestamp:new Date,source:"chat"};if(q(p=>[...p,E]),ne&&ce==="connected"){const p=window.LivekitClient,P=JSON.stringify({type:"chat",text:n,timestamp:new Date().toISOString(),source:"typed"}),L=new TextEncoder().encode(P);await ne.localParticipant.publishData(L,p.DataPacket_Kind.RELIABLE),console.log("ðŸ’¬ Message sent via LiveKit:",n)}else setTimeout(()=>{const p=["I understand you're looking for help. Let me assist you with that based on my training and configuration.","Thank you for your message. As an AI Employee, I'm designed to help with various tasks in a professional manner.","I appreciate your question. Based on my role as your AI Employee, I'd be happy to provide assistance.","That's an interesting point. As your AI Employee, here's how I can help you.","I see what you're asking about. As an AI Employee, I'm here to provide helpful, accurate information."],P={id:`fallback-${Date.now()}-${Math.random()}`,text:p[Math.floor(Math.random()*p.length)],isUser:!1,timestamp:new Date,source:"chat"};q(S=>[...S,P]),J(!1)},1e3+Math.random()*2e3)}catch(E){console.error("Error sending message:",E),J(!1)}},ms=g.useCallback(async()=>{try{if(we(!0),re("ðŸŽ¤ Requesting microphone access..."),X("connecting"),Z("Initializing call..."),!window.isSecureContext)throw new Error("HTTPS required for microphone access");try{(await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!1,channelCount:1,sampleRate:48e3,sampleSize:16}})).getTracks().forEach(P=>P.stop()),re("âœ… Microphone access granted"),console.log("âœ… Microphone access granted")}catch(p){const P=p instanceof Error?p.message:"Unknown error";throw new Error(`Microphone access denied: ${P}`)}const n=s==null?void 0:s.id;if(!n)throw new Error("Agent ID not found");re("ðŸ”— Getting LiveKit token...");const x=`admin_test_${Date.now()}`;console.log("ðŸ”‘ Getting token with parameters:",{agent_id:n,language:"en-US",call_id:x,device:"desktop"});const v=await fetch("https://python.service.callshivai.com/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_id:n,language:"en-US",call_id:x,device:"desktop",user_agent:navigator.userAgent})});if(!v.ok){const p=await v.text();throw console.error("âŒ Token server error:",p),new Error(`Failed to get LiveKit token: ${v.status} - ${p}`)}const E=await v.json();if(console.log("ðŸŽ¯ Token received for agent testing:",n,E),re("ðŸ”— Connecting to LiveKit..."),typeof window.LivekitClient>"u"){re("ðŸ“¦ Loading LiveKit SDK...");const p=document.createElement("script");p.src="https://unpkg.com/livekit-client@latest/dist/livekit-client.umd.js",p.onload=()=>{console.log("âœ… LiveKit SDK loaded"),wt(E)},p.onerror=()=>{throw new Error("Failed to load LiveKit SDK")},document.head.appendChild(p)}else await wt(E)}catch(n){console.error("Failed to start agent test call:",n),re(`âŒ Error: ${n instanceof Error?n.message:"Unknown error"}`),X("disconnected"),Z("Connection failed"),we(!1),ke(!1)}},[s]),wt=g.useCallback(async n=>{try{const x=window.LivekitClient,v=new x.Room({adaptiveStream:!0,dynacast:!0,audioCaptureDefaults:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,suppressLocalAudioPlayback:!0},publishDefaults:{audioPreset:x.AudioPresets.speech,dtx:!0,red:!1,simulcast:!1}});v.on(x.RoomEvent.TrackSubscribed,E=>{if(E.kind===x.Track.Kind.Audio){console.log("ðŸ”Š Audio track received from agent");const p=E.attach();p.volume=.4,p.autoplay=!0,document.body.appendChild(p),p.play().catch(P=>console.warn("Audio autoplay blocked:",P))}}),v.on(x.RoomEvent.DataReceived,(E,p)=>{var P,S;try{const L=new TextDecoder().decode(E);if(console.log("ðŸ“¨ DataReceived:",L,"from:",p==null?void 0:p.identity),!L||L.trim().length===0||["subscribed","connected","disconnected","enabled","disabled","true","false"].some(U=>L.toLowerCase()===U))return;try{const U=JSON.parse(L);let I="";const Ne=["text","transcript","message","content","response"];for(const ee of Ne)if(U[ee]&&typeof U[ee]=="string"&&U[ee].trim()){I=U[ee].trim();break}if(I){const ee=(p==null?void 0:p.identity)===((P=v.localParticipant)==null?void 0:P.identity),tt=`${ee?"user":"ai"}-${I}-${Math.floor(Date.now()/2e3)}`;if(F.current.has(tt)){console.log("ðŸš« Preventing duplicate DataReceived:",I);return}F.current.add(tt),setTimeout(()=>F.current.delete(tt),5e3),q(ys=>[...ys,{id:`${Date.now()}-${Math.random()}`,text:I,isUser:ee,timestamp:new Date,source:"voice"}]),ee||J(!1),console.log("âœ… Added real-time message:",{isUser:ee,text:I})}}catch{if(L.length>=2&&L.length<=1e3){const I=(p==null?void 0:p.identity)===((S=v.localParticipant)==null?void 0:S.identity),Ne=`${I?"user":"ai"}-${L.trim()}-${Math.floor(Date.now()/2e3)}`;if(F.current.has(Ne)){console.log("ðŸš« Preventing duplicate plain text:",L.trim());return}F.current.add(Ne),setTimeout(()=>F.current.delete(Ne),5e3),q(ee=>[...ee,{id:`${Date.now()}-${Math.random()}`,text:L.trim(),isUser:I,timestamp:new Date,source:"voice"}]),I||J(!1),console.log("âœ… Added plain text message:",{isUser:I,text:L.trim()})}}}catch(L){console.error("âŒ Error processing DataReceived:",L)}}),typeof v.registerTextStreamHandler=="function"&&(console.log("ðŸ“ Registering text stream handlers..."),v.registerTextStreamHandler("lk.transcription",async(E,p)=>{var P;console.log("ðŸŽ¯ Transcription stream from:",p.identity);try{const S=await E.readAll();if(S&&S.trim()){const L=p.identity===((P=v.localParticipant)==null?void 0:P.identity),z=`${L?"user":"ai"}-transcription-${S.trim()}-${Math.floor(Date.now()/2e3)}`;if(F.current.has(z)){console.log("ðŸš« Preventing duplicate transcription:",S.trim());return}F.current.add(z),setTimeout(()=>F.current.delete(z),5e3),q(U=>[...U,{id:`transcription-${Date.now()}-${Math.random()}`,text:S.trim(),isUser:L,timestamp:new Date,source:"voice"}]),L||J(!1),console.log("âœ… Transcription added:",{isUser:L,text:S.trim()})}}catch(S){console.error("âŒ Error processing transcription:",S)}}),v.registerTextStreamHandler("lk.chat",async(E,p)=>{var P;console.log("ðŸ’¬ Chat stream from:",p.identity);try{const S=await E.readAll();if(!(p.identity===((P=v.localParticipant)==null?void 0:P.identity))&&S&&S.trim()){const z=`ai-chat-${S.trim()}-${Math.floor(Date.now()/2e3)}`;if(F.current.has(z)){console.log("ðŸš« Preventing duplicate chat:",S.trim());return}F.current.add(z),setTimeout(()=>F.current.delete(z),5e3),q(U=>[...U,{id:`chat-${Date.now()}-${Math.random()}`,text:S.trim(),isUser:!1,timestamp:new Date,source:"chat"}]),J(!1),console.log("âœ… Chat message added:",{text:S.trim()})}}catch(S){console.error("âŒ Error processing chat:",S)}})),v.on(x.RoomEvent.ParticipantMetadataChanged,(E,p)=>{var P;if(E)try{const S=JSON.parse(E);if(S.transcript||S.text){const L=(p==null?void 0:p.identity)===((P=v.localParticipant)==null?void 0:P.identity);q(z=>[...z,{id:`metadata-${Date.now()}`,text:S.transcript||S.text,isUser:L,timestamp:new Date,source:"voice"}]),L||J(!1),console.log("âœ… Transcript from participant metadata:",S.transcript||S.text)}}catch{console.log("Metadata not JSON:",E)}}),v.on(x.RoomEvent.RoomMetadataChanged,E=>{if(E)try{const p=JSON.parse(E);(p.transcript||p.text)&&(q(P=>[...P,{id:`room-metadata-${Date.now()}`,text:p.transcript||p.text,isUser:!1,timestamp:new Date,source:"voice"}]),J(!1),console.log("âœ… Transcript from room metadata:",p.transcript||p.text))}catch{console.log("Room metadata not JSON:",E)}}),v.on(x.RoomEvent.Connected,async()=>{console.log("ðŸŽ‰ Connected to LiveKit room for agent testing"),ke(!0),we(!1),M(!0),X("connected"),re("ðŸŸ¢ Connected! You can now speak with the agent."),Z("âœ… Connected - Speak now!");const E=setInterval(()=>{ae(p=>p+1)},1e3);ye(E);try{await v.localParticipant.setMicrophoneEnabled(!0,{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}),Le(!0),console.log("ðŸŽ¤ Microphone enabled and ready")}catch(p){console.error("Failed to enable microphone:",p)}}),v.on(x.RoomEvent.Disconnected,()=>{console.log("âŒ Disconnected from LiveKit room"),ke(!1),we(!1),M(!1),X("disconnected"),re("ðŸ”´ Disconnected"),Z("âŒ Disconnected"),Ve(null),W&&(clearInterval(W),ye(null)),ae(0)}),console.log("ðŸ”— Connecting to LiveKit room..."),await v.connect(n.url,n.token),Ve(v)}catch(x){console.error("LiveKit connection failed:",x),re(`âŒ Connection failed: ${x instanceof Error?x.message:"Unknown error"}`),X("disconnected"),Z("Connection failed"),we(!1),ke(!1)}},[s,W]),xs=g.useCallback(async()=>{if(ne)try{await ne.disconnect(),console.log("âœ… Disconnected from LiveKit room")}catch(n){console.error("Error disconnecting from room:",n)}ke(!1),we(!1),M(!1),X("disconnected"),re("ðŸ“ž Call ended"),Z("Ready to connect"),Ve(null),Le(!1),W&&(clearInterval(W),ye(null)),ae(0),q(n=>[...n,{id:`disconnect-${Date.now()}`,text:"Call ended",isUser:!1,timestamp:new Date,source:"system"}])},[ne,W]),us=g.useCallback(async()=>{if(ne&&mt)try{const n=!ge;await ne.localParticipant.setMicrophoneEnabled(!n),es(n),Le(!n),console.log(`ðŸŽ¤ Microphone ${n?"muted":"unmuted"}`)}catch(n){console.error("Error toggling mute:",n)}},[ne,mt,ge]),hs=g.useCallback(async()=>{if(!s){alert("No agent selected");return}console.log("ðŸ§ª Testing connection components...");try{console.log("ðŸŽ¤ Testing microphone access..."),await navigator.mediaDevices.getUserMedia({audio:!0}),console.log("âœ… Microphone access OK"),console.log("ðŸ”‘ Testing token server...");const n=await fetch("https://python.service.callshivai.com/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_id:s.id,language:"en-US",call_id:`test_${Date.now()}`,device:"desktop",user_agent:navigator.userAgent})});if(n.ok){const x=await n.json();console.log("âœ… Token server OK",x),alert("âœ… Connection test passed! Token server is working. Try starting the call again.")}else console.error("âŒ Token server error:",n.status),alert(`âŒ Token server error: ${n.status}. The voice service may be temporarily unavailable.`)}catch(n){console.error("âŒ Connection test failed:",n),n instanceof Error&&n.name==="NotAllowedError"?alert("âŒ Microphone permission denied. Please allow microphone access and try again."):n instanceof Error&&n.message.includes("fetch")?alert("âŒ Cannot reach voice service. Please check your internet connection."):alert(`âŒ Connection test failed: ${n instanceof Error?n.message:"Unknown error"}`)}},[s]),gs=ms,ps=xs,fs=us,bs=n=>{const x=Math.floor(n/60),v=n%60;return`${x.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`},vs=[{value:"Concise",label:"Concise"},{value:"Balanced",label:"Balanced"},{value:"Detailed",label:"Detailed"}],ws=[{value:"Short (50 words)",label:"Short (50 words)"},{value:"Medium (150 words)",label:"Medium (150 words)"},{value:"Long (300 words)",label:"Long (300 words)"}],js=[{value:"Small (4K tokens)",label:"Small (4K tokens)"},{value:"Standard (8K tokens)",label:"Standard (8K tokens)"},{value:"Large (16K tokens)",label:"Large (16K tokens)"}],jt=w?r.filter(n=>{const x=n.name.toLowerCase().includes(N.toLowerCase()),v=b==="all"||n.status.toLowerCase()===b.toLowerCase();return x&&v}):[];return y?e.jsxs("div",{className:"space-y-4 lg:space-y-6 w-full max-w-full overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 lg:gap-4 flex-1",children:[e.jsxs("div",{className:"bg-white/50 flex items-center justify-center gap-1.5 dark:bg-slate-800/50 rounded-lg px-2 lg:px-6 py-2 lg:py-2 text-center shadow-sm transition-all duration-200 hover:shadow-md",children:[e.jsx("p",{className:"text-base lg:text-2xl font-bold text-slate-800 dark:text-white",children:w?r.length:0}),e.jsx("p",{className:"text-[10px] lg:text-sm font-medium text-slate-600 dark:text-slate-400",children:"Total"})]}),e.jsxs("div",{className:"bg-white/50 flex items-center justify-center gap-1.5 dark:bg-slate-800/50 rounded-lg px-2 lg:px-6 py-2 lg:py-2 text-center shadow-sm transition-all duration-200 hover:shadow-md",children:[e.jsx("p",{className:"text-base lg:text-2xl font-bold text-green-600 dark:text-green-400",children:w?r.filter(n=>n.status==="Published").length:0}),e.jsx("p",{className:"text-[10px] lg:text-sm font-medium text-slate-600 dark:text-slate-400",children:"Active"})]}),e.jsxs("div",{className:"bg-white/50 flex items-center justify-center gap-1.5 dark:bg-slate-800/50 rounded-lg px-2 lg:px-6 py-2 lg:py-2 text-center shadow-sm transition-all duration-200 hover:shadow-md",children:[e.jsx("p",{className:"text-base lg:text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:w?r.filter(n=>n.status==="Training").length:0}),e.jsx("p",{className:"text-[10px] lg:text-sm font-medium text-slate-600 dark:text-slate-400",children:"Training"})]})]}),e.jsxs("button",{onClick:()=>w&&a("/agents/create"),disabled:!w,className:`flex items-center justify-center gap-2 px-4 lg:px-6 py-2.5 lg:py-3 rounded-xl transition-all duration-200 shadow-sm whitespace-nowrap ${w?"common-button-bg transform hover:scale-[1.02] active:scale-[0.98] cursor-pointer":"bg-gray-400 dark:bg-gray-600 text-gray-200 dark:text-gray-300 cursor-not-allowed opacity-50"}`,children:[e.jsx(Bs,{className:"w-4 h-4 lg:w-5 lg:h-5"}),e.jsx("span",{className:"text-sm lg:text-base font-medium",children:"Create AI Employee"})]})]}),e.jsx(R,{children:e.jsxs("div",{className:"p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400 z-10"}),e.jsx("input",{type:"text",placeholder:"Search agents...",value:N,onChange:n=>$(n.target.value),className:"w-full pl-10 pr-4 py-2.5 lg:py-3 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500/20 text-slate-800 dark:text-white text-sm transition-all duration-200"})]}),e.jsx("div",{className:"hidden lg:block min-w-[180px]",children:e.jsx(pe,{options:[{value:"all",label:"All Status"},{value:"published",label:"Published"},{value:"draft",label:"Draft"},{value:"training",label:"Training"}],value:b,onChange:n=>se(n),placeholder:"Filter by status..."})}),e.jsx("button",{className:"lg:hidden flex items-center justify-center common-button-bg2 p-2.5 rounded-lg active:scale-95",children:e.jsx(Nt,{className:"w-4 h-4"})})]}),(N||b!=="all")&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3 pt-3 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Active filters:"}),N&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs flex items-center gap-1",children:['"',N,'"',e.jsx("button",{onClick:()=>$(""),className:"hover:bg-blue-200 dark:hover:bg-blue-800/50 rounded-full p-0.5",children:"âœ•"})]}),b!=="all"&&e.jsxs("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-full text-xs flex items-center gap-1",children:["Status: ",b,e.jsx("button",{onClick:()=>se("all"),className:"hover:bg-green-200 dark:hover:bg-green-800/50 rounded-full p-0.5",children:"âœ•"})]}),e.jsx("button",{onClick:()=>{$(""),se("all")},className:"text-xs text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 underline",children:"Clear all"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 sm:gap-4 lg:gap-6",children:jt.map(n=>e.jsx(R,{hover:!0,children:e.jsxs("div",{className:"p-4 sm:p-5 lg:p-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"w-10 sm:w-12 h-10 sm:h-12 common-bg-icons rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(Ce,{className:"w-5 sm:w-6 h-5 sm:h-6 text-slate-900 dark:text-slate-100"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white text-sm sm:text-base truncate",children:n.name}),e.jsxs("p",{className:"text-xs sm:text-sm text-slate-500 dark:text-slate-400 truncate",children:[n.language," â€¢ ",n.persona]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium flex-shrink-0 ${n.status==="Published"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":n.status==="Training"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300"}`,children:n.status})]})})]}),e.jsxs("div",{className:"space-y-2 mb-4 sm:mb-5",children:[e.jsxs("div",{className:"flex items-center justify-start text-xs sm:text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Voice:"}),e.jsx("span",{className:"text-slate-800 dark:text-white truncate ml-2 text-right",children:n.voice})]}),e.jsxs("div",{className:"flex items-center justify-start text-xs sm:text-sm",children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Created:"}),e.jsx("span",{className:"text-slate-800 dark:text-white ml-2",children:n.createdAt.toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsxs("button",{onClick:()=>a(`/agents/${n.id}`),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-all duration-200 text-sm font-medium active:scale-[0.98]",children:[e.jsx(St,{className:"w-4 h-4"}),"View"]}),e.jsxs("button",{onClick:()=>a(`/agents/${n.id}/edit`),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-600 transition-all duration-200 text-sm font-medium active:scale-[0.98]",children:[e.jsx(Ie,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("button",{onClick:()=>a(`/agents/${n.id}/train`,{state:{from:"list"}}),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-300 rounded-lg hover:bg-purple-100 dark:hover:bg-purple-900/30 transition-all duration-200 text-sm font-medium active:scale-[0.98]",children:[e.jsx(Tt,{className:"w-4 h-4"}),"Train"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[n.status==="Published"?e.jsxs("button",{onClick:()=>Me(n.id),disabled:O.has(n.id),className:`flex-1 flex items-center justify-center gap-1.5 common-button-bg2 transition-all duration-200 text-sm font-medium ${O.has(n.id)?"opacity-50 cursor-not-allowed":"active:scale-[0.98]"}`,children:[O.has(n.id)?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):e.jsx(Re,{className:"w-4 h-4"}),O.has(n.id)?"Pausing...":"Pause"]}):e.jsxs("button",{onClick:()=>n.is_active?Me(n.id):bt(n.id),disabled:O.has(n.id),className:`flex-1 flex items-center justify-center gap-1.5 transition-all duration-200 text-sm font-medium ${O.has(n.id)?"opacity-50 cursor-not-allowed":"active:scale-[0.98]"} ${n.is_active?"common-button-bg2":"common-button-bg"}`,children:[O.has(n.id)?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):n.is_active?e.jsx(Re,{className:"w-4 h-4"}):e.jsx(st,{className:"w-4 h-4"}),O.has(n.id)?n.is_active?"Pausing...":"Publishing...":n.is_active?"Pause":"Publish"]}),e.jsx("button",{className:"p-2.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 active:scale-95",children:e.jsx(Ue,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2.5 text-slate-400 hover:text-red-500 transition-colors rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 active:scale-95",children:e.jsx(Os,{className:"w-4 h-4"})})]})]})},n.id))}),jt.length===0&&e.jsxs("div",{className:"text-center py-12 lg:py-16 px-4",children:[e.jsx(Ce,{className:"w-20 lg:w-24 h-20 lg:h-24 text-slate-300 dark:text-slate-600 mx-auto mb-6"}),e.jsx("h3",{className:"text-xl lg:text-2xl font-medium text-slate-600 dark:text-slate-400 mb-3",children:N||b!=="all"?"No agents found":"No agents created yet"}),e.jsx("p",{className:"text-sm lg:text-base text-slate-500 dark:text-slate-500 max-w-md lg:max-w-lg mx-auto mb-6 leading-relaxed",children:N||b!=="all"?"Try adjusting your search or filter criteria to find what you're looking for":"Create your first AI agent to get started with automated conversations and boost your business efficiency"}),!N&&b==="all"&&w&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>a("/agents/create"),className:"w-full sm:w-auto common-button-bg px-6 py-3 rounded-xl shadow-sm hover:shadow-md transform hover:scale-[1.02] active:scale-[0.98]",children:"Create Your First Agent"}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-400 dark:text-slate-500",children:"Get started in just 2 minutes âš¡"})]}),(N||b!=="all")&&e.jsx("button",{onClick:()=>{$(""),se("all")},className:"w-full sm:w-auto common-button-bg2 px-6 py-2.5 rounded-lg",children:"Clear Filters"})]})]}):D&&s?e.jsxs("div",{className:"space-y-3 sm:space-y-4 lg:space-y-6 w-full",children:[e.jsx(R,{children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 lg:gap-4 min-w-0 flex-1",children:[e.jsx("button",{onClick:()=>a("/agents"),className:"common-button-bg2 p-1.5 sm:p-2.5 rounded-lg sm:rounded-xl flex-shrink-0 touch-manipulation",children:e.jsx(Et,{className:"w-4 sm:w-5 h-4 sm:h-5 text-slate-600 dark:text-slate-300"})}),e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 lg:gap-4 min-w-0 flex-1",children:[e.jsx("div",{className:"w-10 h-10 sm:w-14 sm:h-14 lg:w-16 lg:h-16 common-bg-icons flex items-center justify-center flex-shrink-0 rounded-lg sm:rounded-xl",children:e.jsx(Ce,{className:"w-5 h-5 sm:w-7 sm:h-7 lg:w-8 lg:h-8 text-black dark:text-white"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"flex flex-col gap-1.5 sm:gap-2 sm:flex-row sm:items-start sm:justify-between",children:e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-base sm:text-xl lg:text-2xl font-bold text-slate-800 dark:text-white leading-tight truncate",children:s.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-2 sm:gap-x-3 gap-y-1 text-xs sm:text-sm text-slate-600 dark:text-slate-400 mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Lt,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"truncate text-xs sm:text-sm",children:s.language})]}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:`px-2 py-0.5 sm:px-3 sm:py-1 rounded-full text-xs font-medium flex-shrink-0 ${s.status==="Published"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":s.status==="Training"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300"}`,children:s.status})})]})]})})})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 lg:gap-3 flex-shrink-0",children:[e.jsxs("button",{onClick:()=>a(`/agents/${s.id}/edit`),className:"flex-1 sm:flex-none common-button-bg2 flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-3 lg:px-4 py-1.5 sm:py-2 lg:py-2.5 rounded-lg sm:rounded-xl touch-manipulation min-h-[36px] sm:min-h-[40px]",children:[e.jsx(Ie,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Edit"})]}),s.status==="Published"&&e.jsxs("button",{onClick:()=>Te(!0),className:"flex-none common-button-bg2 flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-3 lg:px-4 py-1.5 sm:py-2 lg:py-2.5 rounded-lg sm:rounded-xl touch-manipulation min-h-[36px] sm:min-h-[40px]",children:[e.jsx(_t,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"QR"})]}),s.status==="Published"?e.jsxs("button",{onClick:()=>Me(s.id),disabled:O.has(s.id),className:`flex-none common-button-bg2 flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-3 lg:px-4 py-1.5 sm:py-2 lg:py-2.5 rounded-lg sm:rounded-xl touch-manipulation min-h-[36px] sm:min-h-[40px] ${O.has(s.id)?"opacity-50 cursor-not-allowed":""}`,children:[O.has(s.id)?e.jsx("div",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):e.jsx(Re,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:O.has(s.id)?"...":"Pause"})]}):e.jsxs("button",{onClick:()=>s.is_active?Me(s.id):bt(s.id),disabled:O.has(s.id),className:`flex-none flex items-center justify-center gap-1 sm:gap-2 px-2 sm:px-3 lg:px-4 py-1.5 sm:py-2 lg:py-2.5 rounded-lg sm:rounded-xl touch-manipulation min-h-[36px] sm:min-h-[40px] ${O.has(s.id)?"opacity-50 cursor-not-allowed":""} ${s.is_active?"common-button-bg2":"common-button-bg"}`,children:[O.has(s.id)?e.jsx("div",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}):s.is_active?e.jsx(Re,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):e.jsx(st,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:O.has(s.id)?"...":s.is_active?"Pause":"Publish"})]})]})]})})}),e.jsxs("div",{className:"lg:hidden grid grid-cols-2 gap-2",children:[e.jsx(R,{className:"hover:shadow-md transition-all duration-200",children:e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-7 h-7 bg-blue-50 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"w-3.5 h-3.5 text-blue-600 dark:text-blue-400"})}),e.jsx("p",{className:"text-base font-bold text-slate-800 dark:text-white",children:s.stats.conversations.toLocaleString()}),e.jsx("p",{className:"text-[10px] text-slate-600 dark:text-slate-400",children:"Conversations"}),s.stats.conversations>0?e.jsx("span",{className:"text-[10px] font-medium text-green-600 dark:text-green-400",children:"+12%"}):e.jsx("span",{className:"text-[10px] text-slate-500 dark:text-slate-500",children:"No data"})]})})}),e.jsx(R,{className:"hover:shadow-md transition-all duration-200",children:e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-7 h-7 bg-green-50 dark:bg-green-900/20 rounded-lg flex items-center justify-center",children:e.jsx(Pt,{className:"w-3.5 h-3.5 text-green-600 dark:text-green-400"})}),e.jsxs("p",{className:"text-base font-bold text-slate-800 dark:text-white",children:[s.stats.successRate,"%"]}),e.jsx("p",{className:"text-[10px] text-slate-600 dark:text-slate-400",children:"Success Rate"}),s.stats.successRate>0?e.jsx("span",{className:"text-[10px] font-medium text-green-600 dark:text-green-400",children:"+2.1%"}):e.jsx("span",{className:"text-[10px] text-slate-500 dark:text-slate-500",children:"No data"})]})})}),e.jsx(R,{className:"hover:shadow-md transition-all duration-200",children:e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-7 h-7 bg-purple-50 dark:bg-purple-900/20 rounded-lg flex items-center justify-center",children:e.jsx(be,{className:"w-3.5 h-3.5 text-purple-600 dark:text-purple-400"})}),e.jsxs("p",{className:"text-base font-bold text-slate-800 dark:text-white",children:[s.stats.avgResponseTime,"s"]}),e.jsx("p",{className:"text-[10px] text-slate-600 dark:text-slate-400",children:"Avg Response"}),s.stats.avgResponseTime>0?e.jsx("span",{className:"text-[10px] font-medium text-green-600 dark:text-green-400",children:"-0.3s"}):e.jsx("span",{className:"text-[10px] text-slate-500 dark:text-slate-500",children:"No data"})]})})}),e.jsx(R,{className:"hover:shadow-md transition-all duration-200",children:e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-7 h-7 bg-orange-50 dark:bg-orange-900/20 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{className:"w-3.5 h-3.5 text-orange-600 dark:text-orange-400"})}),e.jsx("p",{className:"text-base font-bold text-slate-800 dark:text-white",children:s.stats.activeUsers}),e.jsx("p",{className:"text-[10px] text-slate-600 dark:text-slate-400",children:"Active Users"}),s.stats.activeUsers>0?e.jsx("span",{className:"text-[10px] font-medium text-green-600 dark:text-green-400",children:"+8%"}):e.jsx("span",{className:"text-[10px] text-slate-500 dark:text-slate-500",children:"No data"})]})})})]}),e.jsxs("div",{className:"hidden lg:grid grid-cols-4 gap-4",children:[e.jsx(R,{className:"hover:shadow-lg transition-all duration-300",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-50 dark:bg-blue-900/20 rounded-xl flex items-center justify-center",children:e.jsx(le,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:s.stats.conversations.toLocaleString()}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Conversations"})]})]}),e.jsx("div",{className:"flex items-center gap-1",children:s.stats.conversations>0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"+12%"}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"this week"})]}):e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"No data yet"})})]})}),e.jsx(R,{className:"hover:shadow-lg transition-all duration-300",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-50 dark:bg-green-900/20 rounded-xl flex items-center justify-center",children:e.jsx(Pt,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:[s.stats.successRate,"%"]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Success Rate"})]})]}),e.jsx("div",{className:"flex items-center gap-1",children:s.stats.successRate>0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"+2.1%"}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"improved"})]}):e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"No data yet"})})]})}),e.jsx(R,{className:"hover:shadow-lg transition-all duration-300",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-50 dark:bg-purple-900/20 rounded-xl flex items-center justify-center",children:e.jsx(be,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:[s.stats.avgResponseTime,"s"]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Avg Response"})]})]}),e.jsx("div",{className:"flex items-center gap-1",children:s.stats.avgResponseTime>0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"-0.3s"}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"faster"})]}):e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"No data yet"})})]})}),e.jsx(R,{className:"hover:shadow-lg transition-all duration-300",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-50 dark:bg-orange-900/20 rounded-xl flex items-center justify-center",children:e.jsx(Fe,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:s.stats.activeUsers}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Active Users"})]})]}),e.jsx("div",{className:"flex items-center gap-1",children:s.stats.activeUsers>0?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:"+8%"}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"today"})]}):e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-500",children:"No data yet"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 sm:gap-4 lg:gap-6",children:[e.jsx("div",{className:"order-1 lg:order-1 lg:col-span-2",children:e.jsx(R,{children:e.jsxs("div",{className:"p-2 sm:p-3",children:[e.jsxs("div",{className:"flex flex-row sm:items-center sm:justify-between gap-2 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-slate-50 dark:bg-slate-800 rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"w-3 h-3 text-slate-600 dark:text-slate-400"})}),e.jsx("h3",{className:"text-xs sm:text-sm font-semibold text-slate-800 dark:text-white",children:"Configuration"})]}),s.status==="Published"&&e.jsxs("button",{onClick:()=>Ee(!0),className:"flex items-center justify-center gap-1.5 sm:gap-2 px-3 py-1.5 sm:py-2 border border-1 dark:bg-green-900/20 text-black dark:text-green-300 rounded-lg hover:bg-green-100 dark:hover:bg-green-900/30 transition-all duration-200 text-xs sm:text-sm font-medium shadow-sm hover:shadow-md self-start",children:[e.jsx(st,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{children:"Test"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-2 bg-slate-50 border dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx(Lt,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Language"})]}),e.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:s.language})]}),e.jsxs("div",{className:"p-2 bg-slate-50 border dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx(le,{className:"w-3 h-3 text-purple-600 dark:text-purple-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Voice"})]}),e.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:s.voice})]}),e.jsxs("div",{className:"p-2 bg-slate-50 border dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx(Fe,{className:"w-3 h-3 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Persona"})]}),e.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:s.persona})]}),e.jsxs("div",{className:"p-2 bg-slate-50 border dark:bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx(be,{className:"w-3 h-3 text-orange-600 dark:text-orange-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Created"})]}),e.jsx("p",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:s.createdAt.toLocaleDateString()})]})]})]})})}),e.jsxs("div",{className:"order-2 lg:order-2",children:[e.jsx("div",{className:"lg:hidden",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>a(`/agents/${s.id}/train`),className:"common-bg-icons hover:shadow-md transition-all duration-200 p-2 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-blue-50 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:e.jsx(_e,{className:"w-3.5 h-3.5 text-blue-600 dark:text-blue-400"})}),e.jsx("p",{className:"text-xs font-medium text-slate-800 dark:text-white",children:"Train"})]})}),e.jsx("button",{onClick:()=>a(`/agents/${s.id}/edit`),className:"common-bg-icons hover:shadow-md transition-all duration-200 p-2 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg flex items-center justify-center",children:e.jsx(Ie,{className:"w-3.5 h-3.5 text-yellow-600 dark:text-yellow-400"})}),e.jsx("p",{className:"text-xs font-medium text-slate-800 dark:text-white",children:"Edit"})]})}),e.jsx("button",{className:"common-bg-icons hover:shadow-md transition-all duration-200 p-2 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-green-50 dark:bg-green-900/20 rounded-lg flex items-center justify-center",children:e.jsx(Ue,{className:"w-3.5 h-3.5 text-green-600 dark:text-green-400"})}),e.jsx("p",{className:"text-xs font-medium text-slate-800 dark:text-white",children:"Clone"})]})}),e.jsx("button",{className:"common-bg-icons hover:shadow-md transition-all duration-200 p-2 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-purple-50 dark:bg-purple-900/20 rounded-lg flex items-center justify-center",children:e.jsx(At,{className:"w-3.5 h-3.5 text-purple-600 dark:text-purple-400"})}),e.jsx("p",{className:"text-xs font-medium text-slate-800 dark:text-white",children:"Export"})]})}),e.jsx("button",{onClick:()=>window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),className:"common-bg-icons hover:shadow-md transition-all duration-200 p-2 rounded-lg touch-manipulation group col-span-2",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-orange-50 dark:bg-orange-900/20 rounded-lg flex items-center justify-center",children:e.jsx(Dt,{className:"w-3.5 h-3.5 text-orange-600 dark:text-orange-400"})}),e.jsx("p",{className:"text-xs font-medium text-slate-800 dark:text-white",children:"Analytics"})]})})]})}),e.jsx("div",{className:"hidden lg:block space-y-4",children:e.jsx(R,{children:e.jsxs("div",{className:"p-3 sm:p-4 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-slate-50 dark:bg-slate-800 rounded-lg sm:rounded-xl flex items-center justify-center",children:e.jsx(Tt,{className:"w-3 h-3 sm:w-4 sm:h-4 text-slate-600 dark:text-slate-400"})}),e.jsx("h3",{className:"text-sm sm:text-base lg:text-lg font-semibold text-slate-800 dark:text-white",children:"Quick Actions"})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("button",{onClick:()=>a(`/agents/${s.id}/train`),className:"w-full common-bg-icons hover:shadow-md transition-all duration-200 p-3 sm:p-4 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-blue-50 dark:bg-blue-900/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(_e,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"text-sm sm:text-base font-medium text-slate-800 dark:text-white",children:"Train Agent"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Improve responses"})]})]})}),e.jsx("button",{onClick:()=>a(`/agents/${s.id}/edit`),className:"w-full common-bg-icons hover:shadow-md transition-all duration-200 p-3 sm:p-4 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(Ie,{className:"w-4 h-4 sm:w-5 sm:h-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"text-sm sm:text-base font-medium text-slate-800 dark:text-white",children:"Edit Agent"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Modify settings"})]})]})}),e.jsx("button",{className:"w-full common-bg-icons hover:shadow-md transition-all duration-200 p-3 sm:p-4 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-green-50 dark:bg-green-900/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(Ue,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"text-sm sm:text-base font-medium text-slate-800 dark:text-white",children:"Clone Agent"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Create duplicate"})]})]})}),e.jsx("button",{className:"w-full common-bg-icons hover:shadow-md transition-all duration-200 p-3 sm:p-4 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-purple-50 dark:bg-purple-900/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(At,{className:"w-4 h-4 sm:w-5 sm:h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"text-sm sm:text-base font-medium text-slate-800 dark:text-white",children:"Export Data"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Download config"})]})]})}),e.jsx("button",{onClick:()=>window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),className:"w-full common-bg-icons hover:shadow-md transition-all duration-200 p-3 sm:p-4 rounded-lg touch-manipulation group",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-orange-50 dark:bg-orange-900/20 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform",children:e.jsx(Dt,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{className:"text-left flex-1",children:[e.jsx("p",{className:"text-sm sm:text-base font-medium text-slate-800 dark:text-white",children:"View Call Analytics"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"See performance data"})]})]})})]})]})})})]})]}),e.jsx("div",{className:"mt-3 sm:mt-4 lg:mt-6",children:e.jsx(Qs,{agentId:s.id,agentName:s.name,isPublished:!0})}),s.status==="Published"&&e.jsx("div",{className:"mt-4 sm:mt-6",children:e.jsx(Js,{currentAgent:s})}),e.jsx("div",{className:"mt-6 sm:mt-8",children:e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white",children:["Session History ",e.jsxs("span",{className:"text-sm font-normal text-slate-500 dark:text-slate-400",children:["(",Ye.length," sessions)"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>Ze(s.id),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",title:"Refresh sessions",children:e.jsx(Nt,{className:"w-4 h-4 text-slate-600 dark:text-slate-400"})})})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400 pointer-events-none"}),e.jsx("input",{type:"text",placeholder:"Search sessions...",value:ts,onChange:n=>ss(n.target.value),className:"w-full h-[38px] pl-10 pr-3 py-2 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-lg text-sm text-slate-800 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-500 dark:focus:ring-slate-400 transition-all"})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[e.jsxs("select",{value:as,onChange:n=>rs(n.target.value),className:"flex-1 h-[38px] px-3 py-2 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-lg text-sm text-slate-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-slate-500 dark:focus:ring-slate-400 transition-all",children:[e.jsx("option",{value:"all",children:"All Devices"}),e.jsx("option",{value:"mobile",children:"Mobile"}),e.jsx("option",{value:"desktop",children:"Desktop"})]}),e.jsxs("select",{value:ns,onChange:n=>ls(n.target.value),className:"flex-1 h-[38px] px-3 py-2 bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-lg text-sm text-slate-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-slate-500 dark:focus:ring-slate-400 transition-all",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"7 days"}),e.jsx("option",{value:"month",children:"30 days"})]})]})]}),qe&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-3 border-slate-300 dark:border-slate-600 border-t-slate-900 dark:border-t-white rounded-full animate-spin mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Loading sessions..."})]}),Xe&&!qe&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 mb-3",children:Xe}),e.jsx("button",{onClick:()=>Ze(s.id),className:"px-4 py-2 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-lg text-sm hover:opacity-90 transition-opacity",children:"Retry"})]}),!qe&&!Xe&&e.jsx("div",{className:"space-y-4",children:Ye.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(le,{className:"w-12 h-12 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"No sessions found for this agent"})]}):Ye.map((n,x)=>{var E,p,P,S;const v=L=>{if(!L)return"N/A";const z=Math.floor(L/60),U=Math.floor(L%60);return`${z}m ${U}s`};return e.jsxs("div",{className:"bg-white dark:bg-slate-800/30 border border-slate-200 dark:border-slate-700/50 rounded-xl p-4 hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(le,{className:"w-5 h-5 text-slate-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 dark:text-white",children:n.session_id||n.id||`Session ${x+1}`}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:n.user_ip||"Unknown caller"})]})]}),e.jsx("button",{onClick:()=>pt(n),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-700 rounded transition-colors",title:"View transcript",children:e.jsx(St,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-1 bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400 text-xs font-medium rounded",children:"Completed"}),n.language&&e.jsx("span",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700/50 text-slate-700 dark:text-slate-300 text-xs font-medium rounded",children:n.language.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-1",children:"Device & Browser"}),e.jsx("p",{className:"text-slate-800 dark:text-white font-medium",children:((E=n.device)==null?void 0:E.device_type)||"Unknown Browser"}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400",children:[((p=n.location)==null?void 0:p.city)||"unknown",", ",((P=n.location)==null?void 0:P.country)||"unknown"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-1",children:"Duration"}),e.jsx("p",{className:"text-slate-800 dark:text-white font-medium",children:v(n.duration_seconds)}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Session time"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-1",children:"Date & Time"}),e.jsx("p",{className:"text-slate-800 dark:text-white font-medium",children:n.start_time?new Date(n.start_time).toLocaleDateString():"N/A"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:n.start_time?new Date(n.start_time).toLocaleTimeString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-1",children:"Messages"}),e.jsx("p",{className:"text-slate-800 dark:text-white font-medium",children:n.total_messages||0}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400",children:["User: ",n.user_messages||0," â€¢ Transcripts: ",n.transcript_count||0]})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700/50",children:e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["IP: ",((S=n.device)==null?void 0:S.ip)||n.user_ip||"unknown"]})})]},n.session_id||n.id||x)})})]})})}),We&&s&&e.jsx(Na,{agent:s,onClose:()=>Te(!1)}),gt&&e.jsx(Ca,{session:gt,onClose:()=>pt(null)}),Ge&&s&&s.status==="Published"&&e.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-[60] flex items-center justify-center p-3 sm:p-4 -top-8",children:e.jsxs("div",{className:"bg-white/95 dark:bg-slate-900/95 backdrop-blur-md rounded-2xl w-full max-w-2xl h-[80vh] max-h-[600px] relative flex flex-col shadow-xl border border-white/20 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200/50 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("h3",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:["Test ",s.name]})]}),e.jsx("button",{onClick:async()=>{if(ne)try{await ne.disconnect()}catch(n){console.error("Error disconnecting on close:",n)}Ee(!1),M(!1),Le(!1),X("disconnected"),Z("Ready to connect"),W&&(clearInterval(W),ye(null)),ae(0),j("call")},className:"w-8 h-8 flex items-center justify-center hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:e.jsx(nt,{className:"w-4 h-4 text-slate-400"})})]}),e.jsx("div",{className:"flex border-b border-slate-200/50 dark:border-slate-700/50",children:[{id:"call",label:"Voice",icon:at},{id:"conversation",label:"Conversation",icon:le}].map(({id:n,label:x,icon:v})=>e.jsxs("button",{onClick:()=>j(n),className:`flex-1 flex items-center justify-center gap-2 py-3 text-xs font-medium transition-colors ${he===n?"text-slate-900 dark:text-white border-b-2 border-slate-900 dark:border-white bg-slate-50/50 dark:bg-slate-800/50":"text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300"}`,children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{children:x})]},n))}),e.jsxs("div",{className:"flex-1 overflow-hidden",children:[he==="call"&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mb-4 mx-auto transition-all ${ce==="connected"?"bg-green-100 dark:bg-green-900/20":ce==="connecting"?"bg-yellow-100 dark:bg-yellow-900/20 animate-pulse":"bg-slate-100 dark:bg-slate-800/50"}`,children:e.jsx(at,{className:`w-8 h-8 ${ce==="connected"?"text-green-600 dark:text-green-400":ce==="connecting"?"text-yellow-600 dark:text-yellow-400":"text-slate-400"}`})}),e.jsx("h3",{className:"text-lg font-medium text-slate-800 dark:text-white mb-1",children:ce==="connected"?"Connected":ce==="connecting"?"Connecting...":"Ready to Call"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:Zt}),C&&e.jsx("p",{className:"text-sm font-mono text-slate-600 dark:text-slate-300 mt-2",children:bs(Q)})]}),e.jsx("div",{className:"flex items-center gap-3",children:!C&&!Je?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:gs,disabled:ve||Je,className:"flex items-center gap-2 px-6 py-3 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-xl hover:bg-slate-800 dark:hover:bg-slate-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:[e.jsx(Hs,{className:"w-4 h-4"}),Je?"Connecting...":"Start Call"]}),e.jsxs("button",{onClick:hs,className:"flex items-center gap-2 px-4 py-3 text-slate-600 dark:text-slate-400 hover:text-slate-800 dark:hover:text-slate-200 transition-colors text-sm",children:[e.jsx($e,{className:"w-4 h-4"}),"Test"]})]}):C?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:fs,className:`p-3 rounded-xl transition-colors ${ge?"bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400":"bg-green-100 dark:bg-green-900/20 text-green-600 dark:text-green-400"}`,title:ge?"Unmute":"Mute",children:ge?e.jsx(Fs,{className:"w-5 h-5"}):e.jsx($s,{className:"w-5 h-5"})}),e.jsx("button",{onClick:ps,className:"p-3 bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-xl hover:bg-red-200 dark:hover:bg-red-900/40 transition-colors",title:"End Call",children:e.jsx(at,{className:"w-5 h-5"})})]}):e.jsxs("div",{className:"flex items-center gap-2 text-slate-500 dark:text-slate-400 text-sm",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-slate-300 dark:border-slate-600 border-t-slate-900 dark:border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Connecting..."})]})}),C&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-slate-500 dark:text-slate-400",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${ge?"bg-red-500":"bg-green-500"}`}),ge?"Muted":"Listening"]})})]}),he==="conversation"&&e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[ct.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(le,{className:"w-8 h-8 text-slate-300 dark:text-slate-600 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Start a conversation to see messages"})]}):ct.map(n=>e.jsx("div",{className:`flex mb-4 ${n.isUser?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex gap-3 max-w-[80%] ${n.isUser?"flex-row-reverse":""}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${n.isUser?"bg-blue-500 text-white":"bg-green-500 text-white"}`,children:n.isUser?e.jsx("span",{className:"text-sm font-medium",children:"U"}):e.jsx("span",{className:"text-sm font-medium",children:"AI"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:n.isUser?"You":"AI Employee"}),e.jsx("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:n.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),n.source&&e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${n.source==="voice"?"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400":"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400"}`,children:n.source==="voice"?"ðŸŽ™ï¸":"ðŸ’¬"})]}),e.jsx("div",{className:`px-4 py-2 rounded-2xl text-sm ${n.isUser?"bg-blue-500 text-white":"bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-200"}`,children:n.text})]})]})},n.id)),ve&&e.jsx("div",{className:"flex justify-start mb-4",children:e.jsxs("div",{className:"flex gap-3 max-w-[80%]",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm font-medium",children:"AI"})}),e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"px-4 py-2 rounded-2xl bg-slate-100 dark:bg-slate-700 text-slate-800 dark:text-slate-200",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-pulse"}),e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-pulse",style:{animationDelay:"0.1s"}}),e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-pulse",style:{animationDelay:"0.2s"}})]})})})]})})]}),e.jsxs("div",{className:"p-4 border-t border-slate-200/50 dark:border-slate-700/50",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:Pe,onChange:n=>Qe(n.target.value),onKeyPress:n=>{n.key==="Enter"&&!ve&&vt()},placeholder:ce==="connected"?"Type a message or use voice...":"Type a message...",className:"flex-1 px-3 py-2 bg-slate-50 dark:bg-slate-800 border-0 rounded-lg focus:outline-none focus:ring-2 focus:ring-slate-900/10 dark:focus:ring-white/10 text-slate-700 dark:text-slate-300 text-sm placeholder-slate-400 dark:placeholder-slate-500",disabled:ve}),e.jsx("button",{onClick:vt,disabled:!Pe.trim()||ve,className:"px-3 py-2 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-lg hover:bg-slate-800 dark:hover:bg-slate-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e.jsx(Ks,{className:"w-4 h-4"})})]}),ce==="connected"&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2 text-center",children:"ðŸ”´ Live conversation â€¢ Voice and text messages"})]})]})]})]})})]}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 w-full max-w-full overflow-visible",children:[e.jsx(R,{children:e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 min-w-0 flex-1",children:[e.jsx("button",{onClick:()=>{window.history.length>1?a(-1):a("/agents")},className:"common-button-bg2 p-2 sm:p-2.5 rounded-xl flex-shrink-0 touch-manipulation",children:e.jsx(Et,{className:"w-4 sm:w-5 h-4 sm:h-5 text-slate-600 dark:text-slate-300"})}),e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 lg:gap-4 min-w-0 flex-1",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 lg:w-20 lg:h-20 common-bg-icons flex items-center justify-center flex-shrink-0 rounded-xl",children:e.jsx(Ce,{className:"w-6 h-6 sm:w-8 sm:h-8 lg:w-10 lg:h-10 text-black dark:text-white"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl lg:text-2xl xl:text-3xl font-bold text-slate-800 dark:text-white leading-tight truncate",children:f?"Create New Agent":`Edit ${(s==null?void 0:s.name)||"Agent"}`}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs sm:text-sm text-slate-600 dark:text-slate-400 mt-1 sm:mt-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($e,{className:"w-3 sm:w-4 h-3 sm:h-4"}),e.jsx("span",{className:"truncate",children:f?"Configuration":"Editing Configuration"})]}),!f&&s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden xs:flex items-center gap-1",children:[e.jsx(be,{className:"w-3 sm:w-4 h-3 sm:h-4"}),e.jsxs("span",{className:"truncate",children:["Created"," ",s.createdAt.toLocaleDateString()]})]}),e.jsxs("div",{className:"xs:hidden flex items-center gap-1",children:[e.jsx(be,{className:"w-3 sm:w-4 h-3 sm:h-4"}),e.jsx("span",{className:"truncate",children:s.createdAt.toLocaleDateString("en-US",{month:"short",day:"numeric"})})]}),e.jsx("div",{className:"flex items-center gap-1 mt-0 md:mt-2 lg:mt-0",children:e.jsx("span",{className:`px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium flex-shrink-0 self-start ${s.status==="Published"?"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400":s.status==="Training"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-400":"bg-slate-100 text-slate-700 dark:bg-slate-700 dark:text-slate-300"}`,children:s.status})})]})]})]})})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[e.jsx("button",{onClick:()=>{window.history.length>1?a(-1):a("/agents")},className:"flex-1 sm:flex-none common-button-bg2 flex items-center justify-center gap-1.5 sm:gap-2 px-3 sm:px-4 py-2 sm:py-2.5 rounded-xl touch-manipulation min-h-[40px]",children:e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:"Cancel"})}),e.jsxs("button",{onClick:ds,className:"flex-1 sm:flex-none common-button-bg flex items-center justify-center gap-1.5 sm:gap-2 px-3 sm:px-4 py-2 sm:py-2.5 rounded-xl touch-manipulation min-h-[40px]",children:[e.jsx($t,{className:"w-3.5 sm:w-4 h-3.5 sm:h-4"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:f?"Create":"Save"})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-[1fr_380px] gap-4 sm:gap-6 lg:gap-8",children:[e.jsxs("div",{className:"space-y-4 sm:space-y-6 min-w-0",children:[e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-5 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 common-bg-icons rounded-lg flex items-center justify-center",children:e.jsx(Ce,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white",children:"Identity"})]}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600 dark:text-slate-400 mb-4 sm:mb-6",children:"Define your agent's basic identity and personality"}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["Agent Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:h.name,onChange:n=>T({...h,name:n.target.value}),placeholder:"Enter a descriptive name for your agent",className:"common-bg-icons w-full px-3 sm:px-4 py-3 sm:py-3 rounded-xl text-slate-800 dark:text-white text-base sm:text-sm transition-all duration-200 touch-manipulation"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1 leading-relaxed",children:"Choose a clear, descriptive name that reflects your agent's purpose"})]}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["Select Gender ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(pe,{options:os,value:h.gender,onChange:n=>T({...h,gender:n}),placeholder:"Select gender...",groupBy:!0})]})}),f&&e.jsxs("div",{className:"col-span-full space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["Business Process"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(pe,{options:De,value:h.businessProcess,onChange:n=>T({...h,businessProcess:n}),placeholder:"Select business process...",groupBy:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["Industry ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(pe,{options:et,value:h.industry,onChange:n=>T({...h,industry:n}),placeholder:"Select your industry...",groupBy:!0})]})]}),h.businessProcess&&h.industry&&e.jsx("div",{className:"p-3 sm:p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/10 dark:to-purple-900/10 border border-blue-200 dark:border-blue-700/30 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx(_e,{className:"w-4 sm:w-5 h-4 sm:h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-slate-800 dark:text-white mb-1 sm:mb-2 text-sm sm:text-base",children:"Template Available"}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-600 dark:text-slate-400 mb-2 sm:mb-3 leading-relaxed",children:"We have a well-reserached template that fits your selected business process and industry. You can view the recommended template or choose to create a custom agent configuration."}),e.jsxs("div",{className:"flex flex-col xs:flex-row gap-2",children:[e.jsx("button",{onClick:()=>K(!0),className:"flex-1 xs:flex-none common-button-bg active:scale-95",children:"View Template"}),e.jsx("button",{onClick:()=>K(!1),className:"flex-1 xs:flex-none common-button-bg2 active:scale-95",children:"Create Custom"})]})]})]})}),H&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl sm:rounded-2xl max-w-2xl w-full max-h-[90vh] sm:max-h-[80vh] overflow-y-auto m-2 sm:m-0",children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-slate-800 dark:text-white pr-2",children:"Recommended Template"}),e.jsx("button",{onClick:()=>K(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors flex-shrink-0",children:e.jsx("span",{className:"text-lg",children:"âœ•"})})]}),(()=>{const n=ft();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-xl",children:[e.jsx("h4",{className:"font-semibold text-slate-800 dark:text-white mb-2",children:n.name}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-3",children:n.description}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.features.map((x,v)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs",children:x},v))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Persona:"}),e.jsx("p",{className:"text-slate-800 dark:text-white",children:n.persona})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Custom Instructions:"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 bg-slate-50 dark:bg-slate-700/30 p-3 rounded-lg",children:n.customInstructions})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Guardrails Level:"}),e.jsx("p",{className:"text-slate-800 dark:text-white",children:n.guardrailsLevel})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 pt-3 sm:pt-4",children:[e.jsx("button",{onClick:cs,className:"flex-1 common-button-bg active:scale-95",children:"Apply Template"}),e.jsx("button",{onClick:()=>K(!1),className:"flex-1 sm:flex-none common-button-bg2 active:scale-95",children:"Create Custom"})]})]})})()]})})})]}),e.jsxs("div",{className:"col-span-full",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:["Persona ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:[{value:"Friendly",label:"Friendly",desc:"Warm and approachable"},{value:"Formal",label:"Formal",desc:"Professional and structured"},{value:"Concise",label:"Concise",desc:"Brief and to the point"},{value:"Empathetic",label:"Empathetic",desc:"Understanding and caring"},{value:"Persuasive (Sales)",label:"Persuasive (Sales)",desc:"Convincing and goal-oriented"},{value:"Reassuring (Support)",label:"Reassuring (Support)",desc:"Calming and supportive"}].map(n=>e.jsxs("button",{onClick:()=>T({...h,persona:n.value}),className:`p-4 text-left border-2 rounded-xl transition-all duration-200 active:scale-[0.98] touch-manipulation ${h.persona===n.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-sm":"border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-800/50"}`,children:[e.jsx("div",{className:"font-medium text-slate-800 dark:text-white text-sm lg:text-base",children:n.label}),e.jsx("div",{className:"text-xs lg:text-sm text-slate-500 dark:text-slate-400 mt-1 leading-tight",children:n.desc})]},n.value))}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2 leading-relaxed",children:"Select the personality style that best fits your agent's role"})]})]})})]})}),e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-5 lg:p-6 z-[99] relative",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 common-bg-icons rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white",children:"Advanced Settings"})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Custom Instructions"}),e.jsx("textarea",{value:h.customInstructions,onChange:n=>T({...h,customInstructions:n.target.value}),placeholder:"Add specific instructions for your agent...",rows:4,className:"common-bg-icons w-full px-3 sm:px-4 py-3 rounded-xl resize-none text-sm sm:text-base transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1 leading-relaxed",children:"Provide specific guidelines, rules, or context for your agent's responses"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Response Style"}),e.jsx(pe,{options:vs,value:h.responseStyle,onChange:n=>T({...h,responseStyle:n}),placeholder:"Select response style..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Maximum Response Length"}),e.jsx(pe,{options:ws,value:h.maxResponseLength,onChange:n=>T({...h,maxResponseLength:n}),placeholder:"Select max length..."})]})]}),e.jsxs("div",{className:"common-bg-icons p-4 rounded-xl",children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-4",children:["Temperature (Creativity):"," ",e.jsxs("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[h.temperature,"%"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-xs text-slate-600 dark:text-slate-400 min-w-[70px] text-left font-medium",children:"Conservative"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-slate-700 rounded-full",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full transition-all duration-300 ease-out",style:{width:`${h.temperature}%`}})}),e.jsx("input",{type:"range",min:"0",max:"100",value:h.temperature,onChange:n=>T({...h,temperature:parseInt(n.target.value)}),className:"absolute top-0 left-0 w-full h-2 opacity-0 cursor-pointer z-20 touch-manipulation",style:{background:"transparent",outline:"none"}}),e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-5 h-5 bg-white dark:bg-slate-100 rounded-full shadow-lg border-2 border-blue-500 dark:border-blue-400 transition-all duration-300 ease-out pointer-events-none z-10 hover:scale-110",style:{left:`calc(${h.temperature}% - 10px)`,transform:"translateY(-50%)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)"},children:e.jsx("div",{className:"absolute inset-1 bg-blue-500 dark:bg-blue-400 rounded-full"})})]}),e.jsx("span",{className:"text-xs text-slate-600 dark:text-slate-400 min-w-[50px] text-right font-medium",children:"Creative"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400 px-2",children:[e.jsx("span",{className:"font-medium",children:"0%"}),e.jsx("span",{className:"font-medium",children:"25%"}),e.jsx("span",{className:"font-medium",children:"50%"}),e.jsx("span",{className:"font-medium",children:"75%"}),e.jsx("span",{className:"font-medium",children:"100%"})]})]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-3 leading-relaxed",children:"Lower values for more consistent responses, higher for more creative answers"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Context Window"}),e.jsx(pe,{options:js,value:h.contextWindow,onChange:n=>T({...h,contextWindow:n}),placeholder:"Select context window..."})]})]})]})})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-5 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 common-bg-icons rounded-lg flex items-center justify-center",children:e.jsx(le,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white",children:"Voice & Language"})]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"Configure language and voice settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["Language ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:h.language,onChange:n=>T({...h,language:n.target.value}),className:"common-bg-icons w-full px-3 sm:px-4 py-3 rounded-xl text-slate-800 dark:text-white text-base sm:text-sm transition-all duration-200 touch-manipulation appearance-none bg-no-repeat bg-right",style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.75rem center",backgroundSize:"1.25rem 1.25rem"},children:[e.jsx("option",{value:"",children:"Select language..."}),e.jsxs("optgroup",{label:"India",children:[e.jsx("option",{value:"Hindi",children:"Hindi"}),e.jsx("option",{value:"Punjabi",children:"Punjabi"}),e.jsx("option",{value:"Tamil",children:"Tamil"}),e.jsx("option",{value:"Telugu",children:"Telugu"}),e.jsx("option",{value:"Bengali",children:"Bengali"}),e.jsx("option",{value:"Marathi",children:"Marathi"}),e.jsx("option",{value:"Gujarati",children:"Gujarati"}),e.jsx("option",{value:"Kannada",children:"Kannada"}),e.jsx("option",{value:"Malayalam",children:"Malayalam"}),e.jsx("option",{value:"Odia",children:"Odia"}),e.jsx("option",{value:"Urdu",children:"Urdu"})]}),e.jsxs("optgroup",{label:"Middle East",children:[e.jsx("option",{value:"Arabic",children:"Arabic"}),e.jsx("option",{value:"Persian",children:"Persian"}),e.jsx("option",{value:"Hebrew",children:"Hebrew"}),e.jsx("option",{value:"Turkish",children:"Turkish"})]}),e.jsxs("optgroup",{label:"Europe",children:[e.jsx("option",{value:"English (UK)",children:"English (UK)"}),e.jsx("option",{value:"French",children:"French"}),e.jsx("option",{value:"German",children:"German"}),e.jsx("option",{value:"Spanish",children:"Spanish"}),e.jsx("option",{value:"Italian",children:"Italian"}),e.jsx("option",{value:"Dutch",children:"Dutch"})]}),e.jsxs("optgroup",{label:"Americas",children:[e.jsx("option",{value:"English (US)",children:"English (US)"}),e.jsx("option",{value:"Spanish (MX)",children:"Spanish (MX)"}),e.jsx("option",{value:"Portuguese (BR)",children:"Portuguese (BR)"}),e.jsx("option",{value:"French (CA)",children:"French (CA)"})]}),e.jsxs("optgroup",{label:"APAC",children:[e.jsx("option",{value:"Chinese (Mandarin)",children:"Chinese (Mandarin)"}),e.jsx("option",{value:"Japanese",children:"Japanese"}),e.jsx("option",{value:"Korean",children:"Korean"}),e.jsx("option",{value:"Thai",children:"Thai"}),e.jsx("option",{value:"Vietnamese",children:"Vietnamese"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:["Voice ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:h.voice,onChange:n=>T({...h,voice:n.target.value}),className:"common-bg-icons w-full px-3 sm:px-4 py-3 rounded-xl text-slate-800 dark:text-white text-base sm:text-sm transition-all duration-200 touch-manipulation appearance-none bg-no-repeat bg-right",style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.75rem center",backgroundSize:"1.25rem 1.25rem"},children:[e.jsx("option",{value:"",children:"Select voice..."}),e.jsxs("optgroup",{label:"English",children:[e.jsx("option",{value:"Sarah - Professional",children:"Sarah - Professional"}),e.jsx("option",{value:"John - Friendly",children:"John - Friendly"}),e.jsx("option",{value:"Emma - Warm",children:"Emma - Warm"})]}),e.jsxs("optgroup",{label:"Hindi",children:[e.jsx("option",{value:"Arjun - Friendly",children:"Arjun - Friendly"}),e.jsx("option",{value:"Priya - Professional",children:"Priya - Professional"}),e.jsx("option",{value:"Raj - Confident",children:"Raj - Confident"})]})]})]})]})]})}),e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-5 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 common-bg-icons rounded-lg flex items-center justify-center",children:e.jsx(Ds,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white",children:"Guardrails Level"}),e.jsx(Gs,{content:"Guardrails control how strictly the agent follows guidelines and handles sensitive topics. Higher levels provide more restrictions but may limit flexibility.",children:e.jsx(Us,{className:"w-4 h-4 text-slate-400 cursor-help"})})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:[{value:"Low",label:"Low",desc:"Minimal restrictions, maximum flexibility"},{value:"Medium",label:"Medium",desc:"Balanced approach with reasonable limits"},{value:"High",label:"High",desc:"Strict guidelines, maximum safety"}].map(n=>e.jsxs("button",{onClick:()=>T({...h,guardrailsLevel:n.value}),className:`w-full p-3 sm:p-4 text-left border-2 rounded-xl transition-all duration-200 active:scale-[0.98] touch-manipulation ${h.guardrailsLevel===n.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-sm":"border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600 hover:bg-slate-50 dark:hover:bg-slate-800/50"}`,children:[e.jsx("div",{className:"font-medium text-slate-800 dark:text-white text-sm sm:text-base",children:n.label}),e.jsx("div",{className:"text-xs sm:text-sm text-slate-500 dark:text-slate-400 mt-1 leading-tight",children:n.desc})]},n.value))})]})}),e.jsx(R,{children:e.jsxs("div",{className:"p-4 sm:p-5 lg:p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 common-bg-icons rounded-lg flex items-center justify-center",children:e.jsx(_e,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-800 dark:text-white",children:"Quick Tips"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-blue-600 dark:text-blue-400 text-xs font-bold",children:"1"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:"Choose a descriptive name"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:"Make it clear what your agent does"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-green-600 dark:text-green-400 text-xs font-bold",children:"2"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:"Match persona to purpose"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:"Sales agents should be persuasive, support agents empathetic"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-purple-100 dark:bg-purple-900/20 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx("span",{className:"text-purple-600 dark:text-purple-400 text-xs font-bold",children:"3"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-800 dark:text-white",children:"Test before publishing"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:"Use training mode to validate responses"})]})]})]})]})})]})]})]})};export{ir as default};
